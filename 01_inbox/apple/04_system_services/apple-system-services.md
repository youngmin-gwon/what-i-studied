---
title: apple-system-services
tags: [apple, system, daemons, tcc, sensors, privacy]
aliases: []
date modified: 2025-12-17 21:40:00 +09:00
date created: 2025-12-16 16:13:15 +09:00
---

## System Services & Sensors Deep Dive

"ì•±ì´ ë§ˆì´í¬ë¥¼ ì“°ë ¤ê³  í•©ë‹ˆë‹¤."
ì´ ë‹¨ìˆœí•œ íŒì—… ë’¤ì—ëŠ” **TCC (Transparency, Consent, and Control)**ë¼ëŠ” ê±°ëŒ€í•œ í”„ë¼ì´ë²„ì‹œ ê°ì‹œ ì‹œìŠ¤í…œì´ ìˆìŠµë‹ˆë‹¤.
ê°œë°œìë¡œì„œ ì‹œìŠ¤í…œ ë°ëª¬(`tccd`, `locationd`)ì´ ì–´ë–»ê²Œ ë‚´ ì•±ì„ ê°ì‹œí•˜ê³  ì œì–´í•˜ëŠ”ì§€ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤.

### ğŸ’¡ ì™œ ì´ê²ƒì„ ì•Œì•„ì•¼ í•˜ë‚˜ìš”? (Context)
- **ê¶Œí•œ ê±°ë¶€ ëŒ€ì‘**: ì‚¬ìš©ìê°€ "í—ˆìš© ì•ˆ í•¨"ì„ ëˆ„ë¥´ë©´ ì•±ì€ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼ í• ê¹Œìš”? ê·¸ëƒ¥ í¬ë˜ì‹œ ë‚˜ê±°ë‚˜ ë¹ˆ í™”ë©´ì„ ë³´ì—¬ì£¼ë©´ ì•ˆ ë©ë‹ˆë‹¤. `Settings`ë¡œ ìœ ë„í•˜ëŠ” UXê°€ í•„ìš”í•©ë‹ˆë‹¤.
- **ë°°í„°ë¦¬ ë“œë ˆì¸**: ìœ„ì¹˜ ì„œë¹„ìŠ¤(`Core Location`)ë‚˜ ì„¼ì„œë¥¼ ê³„ì† ì¼œë‘ë©´ `locationd` ë°ëª¬ì´ CPUë¥¼ ì¡ì•„ë¨¹ì–´ ë°°í„°ë¦¬ ì†Œëª¨ì˜ ì£¼ë²”ìœ¼ë¡œ ì§€ëª©ë©ë‹ˆë‹¤.
- **Privacy Indicators**: ë§ˆì´í¬/ì¹´ë©”ë¼ ì‚¬ìš© ì‹œ ìƒíƒœ í‘œì‹œì¤„ì— ëœ¨ëŠ” ì£¼í™©ìƒ‰/ì´ˆë¡ìƒ‰ ì ì€ ì‹œìŠ¤í…œ ë ˆë²¨ ê°•ì œ ì‚¬í•­ì…ë‹ˆë‹¤. ëª°ë˜ ë…¹ìŒ/ì´¬ì˜ì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

---

### ğŸ›¡ï¸ TCC (Transparency, Consent, Control)

ëª¨ë“  ë¯¼ê°í•œ ë°ì´í„° ì ‘ê·¼ì€ `tccd` ë°ëª¬ì´ ì¤‘ê°œí•©ë‹ˆë‹¤.
ì•±ì´ ì—°ë½ì²˜ì— ì ‘ê·¼í•˜ë ¤ í•˜ë©´, ì»¤ë„ì´ ì´ë¥¼ ê°€ë¡œì±„ê³  `tccd`ì—ê²Œ ë¬¼ì–´ë´…ë‹ˆë‹¤. "ì´ ì•±, í—ˆë½ ë°›ì•˜ì–´?"

1. **Info.plist**: `NSCameraUsageDescription` ê°™ì€ í‚¤ê°€ ì—†ìœ¼ë©´ ì•„ì˜ˆ ë¬¼ì–´ë³´ì§€ë„ ì•Šê³  ì•±ì„ ê°•ì œ ì¢…ë£Œ(Crash)ì‹œí‚µë‹ˆë‹¤. "ì™œ ì“°ëŠ”ì§€" ì„¤ëª…í•˜ëŠ” ê²ƒì´ í•„ìˆ˜ì…ë‹ˆë‹¤.
2. **Consent**: ì‚¬ìš©ìì—ê²Œ íŒì—…ì„ ë„ì›ë‹ˆë‹¤. í•œ ë²ˆ ê±°ì ˆë˜ë©´ ì•± ë‚´ì—ì„œ ë‹¤ì‹œ ë„ìš¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (OS ì •ì±…).
3. **Database**: ìŠ¹ì¸ ì—¬ë¶€ëŠ” `/Library/Application Support/com.apple.TCC/TCC.db`ì— ì €ì¥ë©ë‹ˆë‹¤ (íƒˆì˜¥/ë£¨íŠ¸ ê¶Œí•œ ì—†ì´ëŠ” ì ‘ê·¼ ë¶ˆê°€).

---

### ğŸ“¡ ì£¼ìš” ì‹œìŠ¤í…œ ë°ëª¬ (The Hidden Workers)

ì•±ì€ ì§ì ‘ í•˜ë“œì›¨ì–´ë¥¼ ì œì–´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. XPCë¥¼ í†µí•´ ë°ëª¬ì—ê²Œ ìš”ì²­í•  ë¿ì…ë‹ˆë‹¤.

#### 1. locationd (ìœ„ì¹˜ ì„œë¹„ìŠ¤)
- **íŠ¹ì§•**: ë°°í„°ë¦¬ ì†Œëª¨ê°€ ê°€ì¥ í½ë‹ˆë‹¤. GPS, Wi-Fi, ì…€ë£°ëŸ¬ ê¸°ì§€êµ­, ë¸”ë£¨íˆ¬ìŠ¤ ë¹„ì½˜ì„ ëª¨ë‘ ì‚¬ìš©í•´ ìœ„ì¹˜ë¥¼ ì‚¼ê°ì¸¡ëŸ‰í•©ë‹ˆë‹¤.
- **ìµœì í™”**: `desiredAccuracy`ë¥¼ ìµœëŒ€ë¡œ ì„¤ì •í•˜ì§€ ë§ˆì„¸ìš”. "3km ì˜¤ì°¨ í—ˆìš©"(`kCLLocationAccuracyThreeKilometers`)ìœ¼ë¡œ ì„¤ì •í•˜ë©´ GPSë¥¼ ë„ê³  ê¸°ì§€êµ­ë§Œ ì‚¬ìš©í•˜ì—¬ ë°°í„°ë¦¬ë¥¼ ì•„ë‚ë‹ˆë‹¤.

#### 2. mediaserverd (ì¹´ë©”ë¼/ì˜¤ë””ì˜¤)
- ì¹´ë©”ë¼ ìº¡ì²˜, ì˜¤ë””ì˜¤ ì…ì¶œë ¥ì„ ì´ê´„í•©ë‹ˆë‹¤.
- ì¹´ë©”ë¼ ì…”í„° ì†Œë¦¬ëŠ” ì´ ë°ëª¬ì´ ê°•ì œë¡œ ë°œìƒì‹œí‚µë‹ˆë‹¤ (êµ­ê°€ë³„ ì •ì±… ì ìš©).
- **Crash**: ë§Œì•½ `mediaserverd`ê°€ ì£½ìœ¼ë©´(ë„ˆë¬´ ë§ì€ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ë“±), ì•±ì˜ ì¹´ë©”ë¼ í”„ë¦¬ë·°ê°€ ê°‘ìê¸° ë©ˆì¶¥ë‹ˆë‹¤. `AVCaptureSessionRuntimeError` ì•Œë¦¼ì„ ë°›ì•„ ì„¸ì…˜ì„ ì¬ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.

#### 3. biometrickitd (FaceID / TouchID)
- ìƒì²´ ì •ë³´ëŠ” **Secure Enclave (SEP)** í•˜ë“œì›¨ì–´ì—ë§Œ ì €ì¥ë˜ë©°, ì•±ì€ ë¬¼ë¡  OSì¡°ì°¨ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- ë°ëª¬ì€ ì˜¤ì§ "ì¼ì¹˜í•¨/ë¶ˆì¼ì¹˜í•¨"ì´ë¼ëŠ” Bool ê°’ë§Œ ë¦¬í„´í•´ì¤ë‹ˆë‹¤.

---

### ğŸ› ï¸ ì‹¤ë¬´ íŒ¨í„´ ë° ì£¼ì˜ì‚¬í•­

#### 1. ê¶Œí•œ ìš”ì²­ ì‹œì  (The Right Time)
ì•± ì¼œìë§ˆì ìœ„ì¹˜/ì˜¤ë””ì˜¤/ì¹´ë©”ë¼ ê¶Œí•œ 3ê°œë¥¼ ì—°ì†ìœ¼ë¡œ ë„ìš°ì§€ ë§ˆì„¸ìš”. ì‚¬ìš©ìëŠ” ë°˜ì‚¬ì ìœ¼ë¡œ "í—ˆìš© ì•ˆ í•¨"ì„ ëˆ„ë¦…ë‹ˆë‹¤.
**Best Practice**: ì‹¤ì œë¡œ ê·¸ ê¸°ëŠ¥ì´ í•„ìš”í•œ ìˆœê°„(ì˜ˆ: "ì§€ë„ ë³´ê¸°" ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ)ì— ìš”ì²­í•˜ì„¸ìš”.

```swift
func requestCameraPermission() {
    let status = AVCaptureDevice.authorizationStatus(for: .video)
    switch status {
    case .notDetermined:
        // ì•„ì§ ê²°ì • ì•ˆ í•¨ -> ìš”ì²­
        AVCaptureDevice.requestAccess(for: .video) { granted in ... }
    case .denied:
        // ê±°ì ˆë¨ -> ì„¤ì •ìœ¼ë¡œ ìœ ë„í•˜ëŠ” ì–¼ëŸ¿ ë„ìš°ê¸°
        showSettingsAlert()
    default:
        break
    }
}
```

#### 2. ì‹œë®¬ë ˆì´í„° í…ŒìŠ¤íŠ¸
ì‹œë®¬ë ˆì´í„°ëŠ” í•˜ë“œì›¨ì–´ ì„¼ì„œê°€ ì—†ìŠµë‹ˆë‹¤.
- **ìœ„ì¹˜**: ë©”ë‰´ì˜ `Features > Location`ì—ì„œ ëª¨ì˜ ì£¼í–‰(City Run) ë“±ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ê¶Œí•œ ë¦¬ì…‹**: í„°ë¯¸ë„ì—ì„œ `xcrun simctl privacy booted reset all` ëª…ë ¹ì–´ë¡œ ê¶Œí•œ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë” ë³´ê¸°
- [apple-interprocess-and-xpc](apple-interprocess-and-xpc.md) - ë°ëª¬ê³¼ í†µì‹ í•˜ëŠ” ì›ë¦¬
- [apple-background-tasks](apple-background-tasks.md) - ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì“°ê¸° ìœ„í•œ ì¡°ê±´
