# 5. 정보보안 관리

## 5.1 정보보안 정책 및 거버넌스

### 5.1.1 정보보안 거버넌스

#### 정보보안 거버넌스 개념
- **정의**: 조직의 정보보안 목표 달성을 위한 경영진의 리더십과 조직구조, 프로세스
- **목적**: 
  - 비즈니스 목표와 정보보안 목표의 일치
  - 전사적 보안 전략 수립 및 실행
  - 보안 투자의 효과성 극대화
  - 법규 및 규제 준수 보장
- **구성 요소**:
  - 정보보안 전략 및 목표
  - 조직 구조 및 역할/책임
  - 정책 및 절차
  - 성과 측정 및 지속적 개선
  - 리스크 관리 체계

#### 정보보안 거버넌스 원칙
```
1. 전략적 정렬 (Strategic Alignment):
   - 비즈니스 전략과 보안 전략의 일치
   - 경영진의 보안 목표 이해 및 지원
   
2. 가치 제공 (Value Delivery):
   - 보안 투자 대비 효과 최적화
   - 비즈니스 가치 창출에 기여
   
3. 리스크 관리 (Risk Management):
   - 체계적인 리스크 식별 및 평가
   - 적절한 리스크 대응 전략 수립
   
4. 자원 관리 (Resource Management):
   - 보안 자원의 효율적 배분
   - 인력, 예산, 기술의 최적 활용
   
5. 성과 측정 (Performance Measurement):
   - 보안 목표 달성도 측정
   - KPI/KRI 기반 모니터링
```

#### IT 거버넌스와의 관계
- **IT 거버넌스**: IT 투자와 성과를 통제하고 관리하는 경영진의 책임
- **정보보안 거버넌스**: IT 거버넌스의 하위 영역이자 핵심 요소
- **연계성**: 
  - IT 전략과 보안 전략의 통합
  - IT 서비스 제공과 보안 통제의 조화
  - 기술 혁신과 보안 요구사항의 균형

#### 보안 거버넌스 프레임워크

##### COBIT (Control Objectives for Information and Related Technologies)
```
COBIT 2019 구조:

거버넌스 시스템 원칙:
1. 이해관계자 요구사항 충족
2. 전사적 시스템 커버
3. 단일 통합 프레임워크 적용
4. 전체론적 접근 활성화
5. 거버넌스와 관리 구분

거버넌스 목표 (5개):
- EDM01: 거버넌스 프레임워크 설정 및 유지
- EDM02: 이익 제공 보장
- EDM03: 리스크 최적화 보장
- EDM04: 자원 최적화 보장
- EDM05: 이해관계자 투명성 보장

관리 목표 (4개 도메인, 37개 프로세스):
- APO (Align, Plan, Organize): 정렬, 계획, 조직
- BAI (Build, Acquire, Implement): 구축, 획득, 구현
- DSS (Deliver, Service, Support): 제공, 서비스, 지원
- MEA (Monitor, Evaluate, Assess): 모니터, 평가, 검토
```

##### ISO/IEC 38500 - IT 거버넌스 국제 표준
```
6가지 원칙:

1. 책임 (Responsibility):
   - 명확한 역할과 책임 정의
   - 의사결정 권한 명시

2. 전략 (Strategy):
   - IT가 조직 전략 지원
   - 현재와 미래 역량 고려

3. 획득 (Acquisition):
   - 적절한 분석 기반 의사결정
   - 균형잡힌 이익, 기회, 비용, 리스크

4. 성과 (Performance):
   - 비즈니스 목적 지원
   - 서비스 제공 및 서비스 수준

5. 적합성 (Conformance):
   - 법규 및 규제 준수
   - 내부 정책 준수

6. 인간 행동 (Human Behavior):
   - 인간의 행동 존중
   - 모든 사람의 요구 고려
```

##### NIST Cybersecurity Framework (CSF)
```
5가지 핵심 기능:

1. 식별 (Identify):
   - 자산 관리
   - 비즈니스 환경
   - 거버넌스
   - 리스크 평가
   - 리스크 관리 전략

2. 보호 (Protect):
   - 접근 제어
   - 인식 및 교육
   - 데이터 보안
   - 정보 보호 프로세스
   - 유지보수
   - 보호 기술

3. 탐지 (Detect):
   - 이상 및 이벤트
   - 보안 지속 모니터링
   - 탐지 프로세스

4. 대응 (Respond):
   - 대응 계획
   - 커뮤니케이션
   - 분석
   - 완화
   - 개선

5. 복구 (Recover):
   - 복구 계획
   - 개선
   - 커뮤니케이션
```

#### 거버넌스 성숙도 모델
```
레벨 0 - 부재 (Non-existent):
- 보안 거버넌스 프로세스 없음
- 보안 인식 부족

레벨 1 - 초기 (Initial):
- 임시방편적 보안 활동
- 문서화되지 않은 프로세스
- 개인 역량에 의존

레벨 2 - 반복 가능 (Repeatable):
- 일부 프로세스 반복 가능
- 기본적인 문서화
- 유사한 절차 따름

레벨 3 - 정의됨 (Defined):
- 표준화된 프로세스
- 전사적 정책 및 절차
- 교육 프로그램 운영

레벨 4 - 관리됨 (Managed):
- 정량적 관리
- 성과 측정 및 모니터링
- 지속적 개선

레벨 5 - 최적화 (Optimized):
- 지속적 프로세스 개선
- 혁신적 기술 도입
- 업계 선도 수준
```

### 5.1.2 정보보안 정책

#### 정보보안 정책 계층
```
정책 피라미드 구조:

┌─────────────────────────────────┐
│   최상위 정책 (Policy)          │  ← 경영진 승인, 전사 적용
│   - 정보보안 기본 정책          │
└─────────────────────────────────┘
         ↓
┌─────────────────────────────────┐
│   중간 정책 (Standards)         │  ← 기술 표준, 측정 가능
│   - 암호화 표준                 │
│   - 접근제어 표준               │
│   - 패스워드 표준               │
└─────────────────────────────────┘
         ↓
┌─────────────────────────────────┐
│   하위 정책 (Procedures)        │  ← 구체적 실행 절차
│   - 계정 생성 절차              │
│   - 백업 절차                   │
│   - 패치 관리 절차              │
└─────────────────────────────────┘
         ↓
┌─────────────────────────────────┐
│   가이드라인 (Guidelines)          │  ← 권고사항, 모범사례
│   - 안전한 코딩 가이드               │
│   - 원격근무 가이드                 │
└─────────────────────────────────┘
```

1. **최상위 정책 (High-level Policy)**:
   - **목적**: 조직의 정보보안 방향과 원칙 제시
   - **승인**: 최고경영진(CEO) 또는 이사회 승인
   - **특징**: 
     - 간결하고 이해하기 쉬운 언어 사용
     - 기술적 세부사항 배제
     - 장기적 관점 (3-5년)
   - **예시 내용**:
     ```
     [회사명] 정보보안 정책
     
     1. 목적
        본 정책은 [회사명]의 정보자산을 보호하고 
        비즈니스 연속성을 보장하기 위함
     
     2. 적용 범위
        - 모든 임직원, 협력업체, 방문자
        - 모든 정보시스템 및 데이터
     
     3. 기본 원칙
        - 기밀성: 인가된 사용자만 접근
        - 무결성: 정보의 정확성 및 완전성 유지
        - 가용성: 필요시 정보 접근 보장
     
     4. 책임
        - CISO: 정보보안 총괄 책임
        - 부서장: 부서 내 정보보안 책임
        - 임직원: 정책 준수 의무
     ```

2. **중간 정책 (Standards)**:
   - **목적**: 기술적 표준 및 구체적 요구사항 명시
   - **특징**: 
     - 측정 가능한 기준 제시
     - 기술적 세부사항 포함
     - 정기적 업데이트 필요
   - **예시 - 패스워드 표준**:
     ```
     패스워드 보안 표준
     
     1. 패스워드 복잡도
        - 최소 길이: 10자 이상
        - 구성: 영문 대소문자, 숫자, 특수문자 중 3종 이상
        - 금지: 사전 단어, 연속/반복 문자
     
     2. 패스워드 변경
        - 주기: 90일마다 변경
        - 재사용 금지: 최근 5개 패스워드
        - 초기 패스워드: 최초 로그인 시 변경 강제
     
     3. 계정 잠금
        - 실패 횟수: 5회 연속 실패 시 잠금
        - 잠금 시간: 30분
        - 해제: 관리자 승인 또는 자동 해제
     
     4. 다중 인증 (MFA)
        - 필수 적용: 관리자 계정, 원격 접속
        - 권장 적용: 일반 사용자 계정
     ```

3. **하위 정책 (Procedures/Guidelines)**:
   - **절차서 (Procedures)**: 단계별 실행 방법
   - **가이드라인 (Guidelines)**: 권장사항 및 모범사례
   - **예시 - 계정 생성 절차**:
     ```
     사용자 계정 생성 절차
     
     1. 계정 신청
        1.1 신청자: 계정 신청서 작성 및 제출
        1.2 부서장: 신청서 검토 및 승인
        1.3 IT 부서: 신청서 접수
     
     2. 계정 생성
        2.1 사용자 정보 확인
        2.2 적절한 권한 그룹 선택
        2.3 계정 생성 및 임시 패스워드 발급
        2.4 계정 정보 기록 (계정 관리 대장)
     
     3. 계정 전달
        3.1 신청자에게 계정 정보 전달 (암호화 채널)
        3.2 최초 로그인 시 패스워드 변경 안내
        3.3 보안 교육 자료 제공
     
     4. 사후 관리
        4.1 계정 사용 현황 모니터링
        4.2 미사용 계정 정기 점검 (90일)
        4.3 퇴사자 계정 즉시 삭제
     ```

#### 주요 정보보안 정책 영역

##### 1. 정보보안 기본 정책
- **내용**: 전사 정보보안 방향 및 원칙
- **포함 사항**:
  - 정보보안 목표 및 비전
  - 적용 범위 및 대상
  - 역할 및 책임
  - 위반 시 제재 조치

##### 2. 정보 분류 정책
```
정보 분류 체계:

등급 1 - 최고비밀 (Top Secret):
- 정의: 유출 시 조직 존립에 치명적 영향
- 예시: 핵심 기술, M&A 정보
- 보호조치:
  * 암호화 필수 (AES-256)
  * 접근 권한: 임원급 이상
  * 보관: 물리적 금고
  * 전송: 승인된 보안 채널만
  * 폐기: 분쇄 후 소각

등급 2 - 대외비 (Confidential):
- 정의: 유출 시 상당한 손실 발생
- 예시: 고객 정보, 재무 정보
- 보호조치:
  * 암호화 권장
  * 접근 권한: 업무 필요자
  * 보관: 잠금 장치 보관함
  * 전송: 암호화 또는 승인된 방법
  * 폐기: 분쇄

등급 3 - 내부용 (Internal):
- 정의: 내부 직원만 접근 가능
- 예시: 내부 공지, 업무 문서
- 보호조치:
  * 기본 접근 제어
  * 접근 권한: 전 직원
  * 외부 공개 금지

등급 4 - 공개 (Public):
- 정의: 공개 가능한 정보
- 예시: 홍보 자료, 공개 발표 자료
- 보호조치: 무결성 보호
```

##### 3. 접근 제어 정책
```python
# 접근 제어 모델 예시

# 1. DAC (Discretionary Access Control) - 임의적 접근 제어
class DACModel:
    def __init__(self):
        self.acl = {}  # Access Control List
    
    def set_permission(self, resource, user, permission):
        """리소스 소유자가 권한 설정"""
        if resource not in self.acl:
            self.acl[resource] = {}
        self.acl[resource][user] = permission
    
    def check_access(self, resource, user, action):
        """접근 권한 확인"""
        if resource in self.acl and user in self.acl[resource]:
            return action in self.acl[resource][user]
        return False

# 2. MAC (Mandatory Access Control) - 강제적 접근 제어
class MACModel:
    LEVELS = {'Public': 1, 'Internal': 2, 'Confidential': 3, 'Top Secret': 4}
    
    def __init__(self):
        self.user_clearance = {}
        self.resource_classification = {}
    
    def set_clearance(self, user, level):
        """사용자 보안 등급 설정"""
        self.user_clearance[user] = self.LEVELS[level]
    
    def set_classification(self, resource, level):
        """리소스 분류 등급 설정"""
        self.resource_classification[resource] = self.LEVELS[level]
    
    def check_access(self, user, resource, action):
        """Bell-LaPadula 모델 적용"""
        user_level = self.user_clearance.get(user, 0)
        resource_level = self.resource_classification.get(resource, 0)
        
        if action == 'read':
            # No Read Up: 상위 등급 읽기 금지
            return user_level >= resource_level
        elif action == 'write':
            # No Write Down: 하위 등급 쓰기 금지
            return user_level <= resource_level
        return False

# 3. RBAC (Role-Based Access Control) - 역할 기반 접근 제어
class RBACModel:
    def __init__(self):
        self.roles = {}
        self.user_roles = {}
        self.permissions = {}
    
    def create_role(self, role_name, permissions):
        """역할 생성 및 권한 할당"""
        self.roles[role_name] = permissions
    
    def assign_role(self, user, role):
        """사용자에게 역할 할당"""
        if user not in self.user_roles:
            self.user_roles[user] = []
        self.user_roles[user].append(role)
    
    def check_access(self, user, resource, action):
        """역할 기반 접근 확인"""
        if user not in self.user_roles:
            return False
        
        for role in self.user_roles[user]:
            if role in self.roles:
                if (resource, action) in self.roles[role]:
                    return True
        return False

# 사용 예시
rbac = RBACModel()

# 역할 정의
rbac.create_role('Admin', [
    ('server', 'read'), ('server', 'write'), ('server', 'execute'),
    ('database', 'read'), ('database', 'write')
])

rbac.create_role('Developer', [
    ('server', 'read'), ('database', 'read')
])

rbac.create_role('User', [
    ('application', 'read'), ('application', 'write')
])

# 사용자에게 역할 할당
rbac.assign_role('alice', 'Admin')
rbac.assign_role('bob', 'Developer')
rbac.assign_role('charlie', 'User')

# 접근 제어 확인
print(rbac.check_access('alice', 'server', 'write'))  # True
print(rbac.check_access('bob', 'server', 'write'))    # False
print(rbac.check_access('charlie', 'database', 'read'))  # False
```

##### 4. 인적 보안 정책
```
채용 단계:
- 신원 조회 및 경력 확인
- 보안 서약서 작성
- 비밀유지 계약(NDA) 체결

재직 단계:
- 정기 보안 교육 (연 2회 이상)
- 보안 인식 제고 캠페인
- 위반 사항 모니터링

퇴직 단계:
- 계정 즉시 삭제
- 회사 자산 반납
- 퇴직 후 비밀유지 의무 확인
```

##### 5. 물리적 보안 정책
```
구역별 보안 등급:

공개 구역 (Public Zone):
- 로비, 회의실
- 방문자 출입 가능
- CCTV 모니터링

제한 구역 (Restricted Zone):
- 사무실
- 출입카드 필요
- 출입 기록 보관

통제 구역 (Controlled Zone):
- 서버실, 네트워크실
- 생체인증 + 출입카드
- 2인 동반 원칙
- 24시간 CCTV 녹화

보안 구역 (Secure Zone):
- 백업 센터
- 다중 인증 필요
- 무장 경비
- 침입 탐지 시스템
```

#### 정책 관리 생명주기
1. **정책 개발**: 요구사항 분석 및 정책 작성
2. **검토 및 승인**: 이해관계자 검토 및 경영진 승인
3. **배포 및 교육**: 조직 내 정책 배포 및 교육 실시
4. **모니터링**: 정책 준수 여부 모니터링
5. **검토 및 개선**: 정기적 정책 검토 및 업데이트

### 5.1.3 조직 및 역할

#### 정보보안 조직 구조
- **CISO (Chief Information Security Officer)**:
  - 최고정보보안책임자
  - 조직의 전체 정보보안 책임
  - 경영진과 IT 부서 간 연결고리
- **정보보안 위원회**:
  - 경영진 및 부서장으로 구성
  - 정보보안 정책 및 전략 결정
  - 보안 투자 및 예산 승인
- **정보보안 실무팀**:
  - 일상적인 보안 업무 수행
  - 보안 시스템 운영 및 관리
  - 보안 사고 대응

#### 역할 및 책임
- **데이터 소유자 (Data Owner)**:
  - 비즈니스 부서의 데이터 책임자
  - 데이터 분류 및 접근 권한 결정
  - 데이터 처리 목적 및 보존 기간 결정
- **데이터 관리자 (Data Custodian)**:
  - IT 부서의 기술적 관리자
  - 데이터 소유자의 지시에 따른 기술적 보호 조치
  - 백업, 복구, 접근 제어 구현
- **시스템 관리자 (System Administrator)**:
  - 시스템 및 네트워크 관리
  - 보안 패치 및 구성 관리
  - 사용자 계정 및 권한 관리

## 5.2 리스크 관리

### 5.2.1 정보보안 리스크 관리 개요

#### 리스크 관리 개념
- **정의**: 조직의 목표 달성에 영향을 줄 수 있는 불확실성의 관리
- **정보보안 리스크**: 정보자산의 기밀성, 무결성, 가용성에 대한 위협
- **리스크 구성 요소**:
  ```
  리스크 = 자산 × 위협 × 취약점
  
  ┌─────────────────────────────────────────────┐
  │  자산 (Asset)                                  │
  │  - 정의: 조직에 가치가 있는 정보 및 시스템      │
  │  - 예시: 데이터베이스, 서버, 애플리케이션, 직원  │
  │  - 평가: 금전적 가치, 비즈니스 영향도          │
  └─────────────────────────────────────────────┘
           ×
  ┌─────────────────────────────────────────────┐
  │  위협 (Threat)                                 │
  │  - 정의: 자산에 손실을 줄 수 있는 요인           │
  │  - 예시: 해커, 맬웨어, 자연재해, 내부자         │
  │  - 특성: 발생 가능성, 공격 동기              │
  └─────────────────────────────────────────────┘
           ×
  ┌─────────────────────────────────────────────┐
  │  취약점 (Vulnerability)                      │
  │  - 정의: 위협이 악용할 수 있는 약점              │
  │  - 예시: 패치 미적용, 약한 패스워드, 설정 오류   │
  │  - 특성: 심각도, 악용 난이도                   │
  └─────────────────────────────────────────────┘
  ```

#### 리스크 관리 프로세스
```
리스크 관리 사이클:

1. 상황 설정 (Context Establishment)
   ↓
2. 리스크 식별 (Risk Identification)
   - 자산 식별
   - 위협 식별
   - 취약점 식별
   ↓
3. 리스크 분석 (Risk Analysis)
   - 발생 가능성 평가
   - 영향도 평가
   - 리스크 수준 계산
   ↓
4. 리스크 평가 (Risk Evaluation)
   - 허용 가능 수준과 비교
   - 우선순위 결정
   ↓
5. 리스크 대응 (Risk Treatment)
   - 대응 전략 선택
   - 통제 구현
   ↓
6. 리스크 모니터링 및 검토 (Monitoring & Review)
   - 지속적 감시
   - 정기적 재평가
   
┌─────────────────────────────────────────────┐
│  소통 및 협의 (Communication & Consultation)  │
│  - 전 과정에서 지속적으로 수행                  │
│  - 이해관계자와의 소통                        │
└─────────────────────────────────────────────┘
```

#### 리스크 식별 기법
```python
# 리스크 식별 도구
from dataclasses import dataclass
from typing import List, Dict
from enum import Enum

class AssetType(Enum):
    HARDWARE = "하드웨어"
    SOFTWARE = "소프트웨어"
    DATA = "데이터"
    PEOPLE = "인력"
    FACILITY = "시설"

class ThreatType(Enum):
    NATURAL = "자연재해"  # 화재, 홍수, 지진
    TECHNICAL = "기술적"    # 하드웨어 장애, 소프트웨어 버그
    HUMAN_ERROR = "인적오류"  # 실수, 부주의
    MALICIOUS = "악의적"    # 해킹, 내부자 위협

@dataclass
class Asset:
    name: str
    type: AssetType
    value: float  # 금전적 가치 (원)
    criticality: int  # 1-5 (5=매우 중요)
    owner: str
    location: str

@dataclass
class Threat:
    name: str
    type: ThreatType
    description: str
    likelihood: int  # 1-5 (5=매우 높음)
    
@dataclass
class Vulnerability:
    name: str
    description: str
    severity: int  # 1-5 (5=매우 심각)
    affected_assets: List[str]
    cvss_score: float = 0.0  # CVSS 점수

@dataclass
class Risk:
    asset: Asset
    threat: Threat
    vulnerability: Vulnerability
    likelihood: int  # 발생 가능성 (1-5)
    impact: int      # 영향도 (1-5)
    risk_level: int  # 리스크 수준 = likelihood × impact
    
class RiskIdentificationTool:
    def __init__(self):
        self.assets: List[Asset] = []
        self.threats: List[Threat] = []
        self.vulnerabilities: List[Vulnerability] = []
        self.risks: List[Risk] = []
    
    def add_asset(self, asset: Asset):
        """자산 등록"""
        self.assets.append(asset)
    
    def add_threat(self, threat: Threat):
        """위협 등록"""
        self.threats.append(threat)
    
    def add_vulnerability(self, vuln: Vulnerability):
        """취약점 등록"""
        self.vulnerabilities.append(vuln)
    
    def identify_risks(self):
        """리스크 식별 - 자산 × 위협 × 취약점 조합"""
        for asset in self.assets:
            for threat in self.threats:
                for vuln in self.vulnerabilities:
                    if asset.name in vuln.affected_assets:
                        # 영향도 계산 (자산 중요도 기반)
                        impact = asset.criticality
                        
                        # 발생 가능성 (위협 가능성 × 취약점 심각도)
                        likelihood = min(5, (threat.likelihood + vuln.severity) // 2)
                        
                        # 리스크 수준 계산
                        risk_level = likelihood * impact
                        
                        risk = Risk(
                            asset=asset,
                            threat=threat,
                            vulnerability=vuln,
                            likelihood=likelihood,
                            impact=impact,
                            risk_level=risk_level
                        )
                        self.risks.append(risk)
    
    def get_risk_matrix(self) -> str:
        """리스크 매트릭스 생성"""
        matrix = "\n리스크 매트릭스 (5x5):\n\n"
        matrix += "    영향도 →\n"
        matrix += "가능성  1    2    3    4    5\n"
        matrix += "↓\n"
        
        for likelihood in range(5, 0, -1):
            matrix += f"{likelihood}   "
            for impact in range(1, 6):
                risk_level = likelihood * impact
                if risk_level <= 5:
                    color = "🟢"  # 낮음 (Low)
                elif risk_level <= 12:
                    color = "🟡"  # 보통 (Medium)
                elif risk_level <= 16:
                    color = "🟠"  # 높음 (High)
                else:
                    color = "🔴"  # 매우높음 (Critical)
                
                matrix += f"{color}{risk_level:2}  "
            matrix += "\n"
        
        matrix += "\n범례:\n"
        matrix += "🟢 낮음 (1-5)  🟡 보통 (6-12)  🟠 높음 (13-16)  🔴 매우높음 (17-25)\n"
        
        return matrix
    
    def generate_risk_report(self) -> str:
        """리스크 보고서 생성"""
        # 리스크 수준별 정렬
        sorted_risks = sorted(self.risks, key=lambda r: r.risk_level, reverse=True)
        
        report = "# 리스크 평가 보고서\n\n"
        report += f"총 식별된 리스크: {len(self.risks)}건\n\n"
        
        # 리스크 수준별 통계
        critical = len([r for r in self.risks if r.risk_level >= 17])
        high = len([r for r in self.risks if 13 <= r.risk_level < 17])
        medium = len([r for r in self.risks if 6 <= r.risk_level < 13])
        low = len([r for r in self.risks if r.risk_level < 6])
        
        report += f"🔴 매우높음: {critical}건\n"
        report += f"🟠 높음: {high}건\n"
        report += f"🟡 보통: {medium}건\n"
        report += f"🟢 낮음: {low}건\n\n"
        
        report += "## 상위 10개 리스크\n\n"
        for i, risk in enumerate(sorted_risks[:10], 1):
            report += f"### {i}. {risk.asset.name} - {risk.threat.name}\n"
            report += f"- **리스크 수준**: {risk.risk_level} "
            report += f"(가능성: {risk.likelihood}, 영향도: {risk.impact})\n"
            report += f"- **취약점**: {risk.vulnerability.name}\n"
            report += f"- **설명**: {risk.threat.description}\n\n"
        
        return report

# 사용 예시
tool = RiskIdentificationTool()

# 자산 등록
tool.add_asset(Asset(
    name="고객 DB 서버",
    type=AssetType.HARDWARE,
    value=500000000,  # 5억원
    criticality=5,
    owner="IT부서",
    location="주 데이터센터"
))

tool.add_asset(Asset(
    name="웹 애플리케이션",
    type=AssetType.SOFTWARE,
    value=200000000,  # 2억원
    criticality=4,
    owner="개발팀",
    location="클라우드"
))

# 위협 등록
tool.add_threat(Threat(
    name="SQL Injection 공격",
    type=ThreatType.MALICIOUS,
    description="웹 애플리케이션을 통한 DB 무단 접근",
    likelihood=4
))

tool.add_threat(Threat(
    name="랭섬웨어 공격",
    type=ThreatType.MALICIOUS,
    description="데이터 암호화 및 금전 요구",
    likelihood=3
))

# 취약점 등록
tool.add_vulnerability(Vulnerability(
    name="입력값 검증 미흡",
    description="사용자 입력에 대한 적절한 검증 부재",
    severity=4,
    affected_assets=["웹 애플리케이션"],
    cvss_score=7.5
))

tool.add_vulnerability(Vulnerability(
    name="패치 미적용",
    description="운영체제 보안 패치 3개월 지연",
    severity=3,
    affected_assets=["고객 DB 서버"],
    cvss_score=6.0
))

# 리스크 식별 및 보고서 생성
tool.identify_risks()
print(tool.get_risk_matrix())
print(tool.generate_risk_report())
```

### 5.2.2 리스크 평가 방법론

#### 정성적 평가 (Qualitative Assessment)
- **특징**: 주관적 판단에 기반한 평가
- **평가 척도**: 상/중/하 또는 1-5점 척도
- **장점**: 빠른 평가, 이해하기 쉬움
- **단점**: 주관적, 정량적 비교 어려움
- **매트릭스 예시**:
  ```
  발생가능성 \ 영향도  낮음  보통  높음
  높음                보통  높음  매우높음
  보통                낮음  보통  높음
  낮음                낮음  낮음  보통
  ```

#### 정량적 평가 (Quantitative Assessment)
- **특징**: 수치적 데이터에 기반한 평가
- **주요 지표**:
  - **ALE (Annual Loss Expectancy)**: 연간 예상 손실
  - **ARO (Annual Rate of Occurrence)**: 연간 발생 빈도
  - **SLE (Single Loss Expectancy)**: 단일 사고 예상 손실
  - **AV (Asset Value)**: 자산 가치
  - **EF (Exposure Factor)**: 노출 요소
- **계산 공식**:
  - SLE = AV × EF
  - ALE = SLE × ARO
- **장점**: 객관적, 투자 대비 효과 분석 가능
- **단점**: 데이터 수집 어려움, 복잡성

#### 반정량적 평가 (Semi-Quantitative Assessment)
- **특징**: 정성적 평가를 수치로 변환
- **방법**: 정성적 척도에 가중치 부여
- **장점**: 정성적 평가의 편의성과 정량적 평가의 객관성 결합

### 5.2.3 리스크 대응 전략

#### 리스크 수용 (Risk Acceptance)
- **정의**: 리스크를 인정하고 받아들이는 전략
- **적용**: 대응 비용이 손실보다 큰 경우
- **조건**: 잔여 리스크가 허용 수준 이내

#### 리스크 회피 (Risk Avoidance)
- **정의**: 리스크 요소를 제거하는 전략
- **방법**: 해당 활동이나 자산 제거
- **예시**: 위험한 서비스 중단, 특정 기술 사용 금지

#### 리스크 완화 (Risk Mitigation)
- **정의**: 리스크의 발생 가능성이나 영향을 줄이는 전략
- **방법**: 보안 통제 구현
- **예시**: 방화벽 설치, 암호화 적용, 백업 시스템 구축

#### 리스크 전가 (Risk Transfer)
- **정의**: 리스크를 제3자에게 이전하는 전략
- **방법**: 보험, 아웃소싱, 계약 조건
- **예시**: 사이버 보험, 클라우드 서비스 이용

### 5.2.4 리스크 관리 표준

#### ISO 31000
- **리스크 관리 원칙**:
  - 가치 창출 및 보호
  - 의사결정의 통합 부분
  - 불확실성 명시적 해결
  - 체계적, 구조적, 시기적절한 접근
  - 최선의 정보 기반
  - 맞춤형
  - 인적 문화적 요소 고려
  - 지속적 개선
- **리스크 관리 프레임워크**: 통합, 설계, 구현, 평가, 개선

#### ISO/IEC 27005
- **정보보안 리스크 관리 국제 표준**
- **ISO/IEC 27001과의 관계**: ISMS 구현을 위한 가이드
- **프로세스**: 상황 설정, 리스크 평가, 리스크 대응, 수용, 소통 및 협의, 모니터링 및 검토

## 5.3 사고 대응

### 5.3.1 보안 사고 관리

#### 보안 사고 정의
```
보안 용어 계층:

보안 이벤트 (Security Event):
- 정의: 보안 관련 식별된 발생 사실
- 예시: 로그인 시도, 파일 접근, 네트워크 패킷
- 특징: 대부분 정상적인 활동

         ↓ (비정상 패턴 감지)

보안 인시던트 (Security Incident):
- 정의: 보안 정책 위반 또는 통제 실패
- 예시: 무단 접근 시도, 정책 위반, 의심 활동
- 특징: 조사 및 대응 필요

         ↓ (실제 피해 발생)

보안 침해 (Security Breach):
- 정의: CIA 중 하나 이상이 손상된 사고
- 예시: 데이터 유출, 시스템 손상, 서비스 중단
- 특징: 심각한 피해, 즉각적 대응 필요
```

#### 사고 분류 체계

##### 심각도별 분류
```
1급 사고 (매우 심각):
- 정의: 전사 또는 핵심 시스템 영향
- 예시:
  * 대규모 개인정보 유출 (10만건 이상)
  * 핵심 시스템 완전 마비
  * 랭섬웨어로 인한 전사 데이터 암호화
- 대응 시간: 15분 이내 초동 대응
- 보고: 경영진 즉시 보고
- 대응팀: 전사 사고대응팀 총동원

2급 사고 (심각):
- 정의: 특정 부서 또는 시스템 영향
- 예시:
  * 소규모 데이터 유출 (1만건 미만)
  * 주요 서비스 일부 중단
  * 웹사이트 훼손
- 대응 시간: 1시간 이내
- 보고: 부서장 및 CISO 보고
- 대응팀: 해당 부서 사고대응팀

3급 사고 (일반):
- 정의: 제한적 영향
- 예시:
  * 단일 시스템 악성코드 감염
  * 정책 위반 행위
  * 의심 이메일 수신
- 대응 시간: 4시간 이내
- 보고: 팀장 보고
- 대응팀: 보안 담당자
```

##### 유형별 분류
```python
# 사고 유형 분류 시스템
from enum import Enum
from dataclasses import dataclass
from datetime import datetime
from typing import List, Optional

class IncidentType(Enum):
    MALWARE = "악성코드 감염"
    HACKING = "해킹 공격"
    DATA_BREACH = "개인정보 유출"
    DDOS = "서비스 거부 공격"
    INSIDER_THREAT = "내부자 위협"
    PHISHING = "피싱 공격"
    RANSOMWARE = "랭섬웨어"
    UNAUTHORIZED_ACCESS = "무단 접근"
    POLICY_VIOLATION = "정책 위반"
    PHYSICAL_SECURITY = "물리적 보안 침해"

class IncidentSeverity(Enum):
    CRITICAL = 1  # 1급
    HIGH = 2      # 2급
    MEDIUM = 3    # 3급
    LOW = 4       # 4급

class IncidentStatus(Enum):
    DETECTED = "탐지"
    ANALYZING = "분석중"
    CONTAINING = "억제중"
    ERADICATING = "근절중"
    RECOVERING = "복구중"
    CLOSED = "종료"

@dataclass
class SecurityIncident:
    incident_id: str
    title: str
    type: IncidentType
    severity: IncidentSeverity
    status: IncidentStatus
    detected_time: datetime
    reported_by: str
    assigned_to: str
    affected_systems: List[str]
    description: str
    initial_response: str = ""
    root_cause: str = ""
    resolution: str = ""
    lessons_learned: str = ""
    closed_time: Optional[datetime] = None

class IncidentManagementSystem:
    def __init__(self):
        self.incidents: List[SecurityIncident] = []
        self.incident_counter = 0
    
    def create_incident(self, title: str, type: IncidentType, 
                       severity: IncidentSeverity, reported_by: str,
                       affected_systems: List[str], description: str) -> str:
        """새로운 보안 사고 등록"""
        self.incident_counter += 1
        incident_id = f"INC-{datetime.now().strftime('%Y%m%d')}-{self.incident_counter:04d}"
        
        incident = SecurityIncident(
            incident_id=incident_id,
            title=title,
            type=type,
            severity=severity,
            status=IncidentStatus.DETECTED,
            detected_time=datetime.now(),
            reported_by=reported_by,
            assigned_to=self._assign_handler(severity),
            affected_systems=affected_systems,
            description=description
        )
        
        self.incidents.append(incident)
        self._send_alert(incident)
        return incident_id
    
    def _assign_handler(self, severity: IncidentSeverity) -> str:
        """심각도에 따른 담당자 할당"""
        if severity == IncidentSeverity.CRITICAL:
            return "CISO 및 전사 사고대응팀"
        elif severity == IncidentSeverity.HIGH:
            return "보안팀장"
        else:
            return "보안 담당자"
    
    def _send_alert(self, incident: SecurityIncident):
        """사고 알림 발송"""
        alert_message = f"""
        ⚠️ 보안 사고 발생 ⚠️
        
        사고 ID: {incident.incident_id}
        제목: {incident.title}
        유형: {incident.type.value}
        심각도: {incident.severity.name}
        탐지 시간: {incident.detected_time.strftime('%Y-%m-%d %H:%M:%S')}
        보고자: {incident.reported_by}
        영향 시스템: {', '.join(incident.affected_systems)}
        
        설명: {incident.description}
        
        담당자: {incident.assigned_to}
        """
        print(alert_message)
        # 실제 환경에서는 이메일, SMS, Slack 등으로 전송
    
    def update_status(self, incident_id: str, new_status: IncidentStatus, 
                     notes: str = ""):
        """사고 상태 업데이트"""
        for incident in self.incidents:
            if incident.incident_id == incident_id:
                incident.status = new_status
                if new_status == IncidentStatus.CLOSED:
                    incident.closed_time = datetime.now()
                print(f"사고 {incident_id} 상태 변경: {new_status.value}")
                if notes:
                    print(f"참고: {notes}")
                break
    
    def get_incident_statistics(self) -> dict:
        """사고 통계 생성"""
        stats = {
            "총 사고 수": len(self.incidents),
            "심각도별": {},
            "유형별": {},
            "상태별": {}
        }
        
        for incident in self.incidents:
            # 심각도별
            severity_name = incident.severity.name
            stats["심각도별"][severity_name] = \
                stats["심각도별"].get(severity_name, 0) + 1
            
            # 유형별
            type_name = incident.type.value
            stats["유형별"][type_name] = \
                stats["유형별"].get(type_name, 0) + 1
            
            # 상태별
            status_name = incident.status.value
            stats["상태별"][status_name] = \
                stats["상태별"].get(status_name, 0) + 1
        
        return stats

# 사용 예시
ims = IncidentManagementSystem()

# 사고 등록
inc1 = ims.create_incident(
    title="웹 서버 SQL Injection 공격 탐지",
    type=IncidentType.HACKING,
    severity=IncidentSeverity.HIGH,
    reported_by="보안모니터링 시스템",
    affected_systems=["Web Server 01", "Database Server"],
    description="웹 애플리케이션 로그에서 비정상적인 SQL 쿼리 패턴 발견"
)

inc2 = ims.create_incident(
    title="랭섬웨어 감염 사고",
    type=IncidentType.RANSOMWARE,
    severity=IncidentSeverity.CRITICAL,
    reported_by="직원 홍길동",
    affected_systems=["File Server", "User PCs (20대)"],
    description="파일 서버 및 다수 PC에서 파일 암호화 및 랭섬 요구 화면 발견"
)

# 사고 상태 업데이트
ims.update_status(inc1, IncidentStatus.ANALYZING, "공격 패턴 분석 중")
ims.update_status(inc2, IncidentStatus.CONTAINING, "감염 시스템 네트워크 격리")

# 통계 확인
stats = ims.get_incident_statistics()
print("\n=== 사고 통계 ===")
for category, data in stats.items():
    print(f"\n{category}:")
    if isinstance(data, dict):
        for key, value in data.items():
            print(f"  {key}: {value}건")
    else:
        print(f"  {data}건")
```

### 5.3.2 사고 대응 프로세스

#### NIST 사고 대응 생명주기
1. **준비 (Preparation)**:
   - 사고 대응팀 구성
   - 정책 및 절차 수립
   - 도구 및 자원 준비
   - 교육 및 훈련 실시

2. **탐지 및 분석 (Detection and Analysis)**:
   - 사고 탐지 및 신고
   - 초기 분석 및 분류
   - 사고 심각도 평가
   - 에스컬레이션 결정

3. **억제, 근절, 복구 (Containment, Eradication, Recovery)**:
   - 사고 확산 방지 (Containment)
   - 근본 원인 제거 (Eradication)
   - 시스템 복구 (Recovery)
   - 정상 서비스 재개

4. **사후 활동 (Post-Incident Activity)**:
   - 사고 보고서 작성
   - 교훈 학습 (Lessons Learned)
   - 프로세스 개선
   - 증거 보관

#### 사고 대응팀 구성
- **팀 리더**: 사고 대응 총괄
- **기술 전문가**: 시스템 분석 및 복구
- **법무 담당자**: 법적 이슈 검토
- **홍보 담당자**: 대외 커뮤니케이션
- **경영진 보고자**: 상급자 보고 및 의사결정 지원

### 5.3.3 디지털 포렌식

#### 디지털 포렌식 개념
- **정의**: 디지털 증거의 수집, 보존, 분석, 발표 과정
- **목적**: 사고 원인 규명, 법적 증거 확보
- **원칙**: 증거의 무결성 보장, 증거 능력 유지

#### 포렌식 프로세스
1. **식별 (Identification)**: 증거 위치 및 범위 결정
2. **보존 (Preservation)**: 증거 무결성 보장
3. **수집 (Collection)**: 증거 획득 및 복사
4. **검사 (Examination)**: 증거 데이터 추출
5. **분석 (Analysis)**: 추출된 데이터 분석
6. **발표 (Presentation)**: 분석 결과 보고

#### 증거 체인 (Chain of Custody)
- **목적**: 증거의 무결성 및 신뢰성 보장
- **기록 사항**: 수집자, 수집 일시, 보관 장소, 이관 내역
- **중요성**: 법적 효력 인정을 위한 필수 요건

#### 주요 포렌식 도구
- **EnCase**: 상용 포렌식 도구
- **FTK (Forensic Toolkit)**: AccessData의 포렌식 도구
- **Autopsy**: 오픈소스 디지털 포렌식 플랫폼
- **Volatility**: 메모리 포렌식 도구
- **Wireshark**: 네트워크 패킷 분석 도구

### 5.3.4 사고 보고 및 커뮤니케이션

#### 내부 보고
- **즉시 보고**: 심각한 사고의 경우 즉시 보고
- **정기 보고**: 일반 사고의 경우 정해진 주기에 보고
- **보고 체계**: 담당자 → 팀장 → 부서장 → 경영진
- **보고 내용**: 사고 개요, 영향 범위, 대응 현황, 향후 계획

#### 외부 보고
- **법적 의무**: 개인정보보호법 등에 따른 신고 의무
- **규제 기관**: 방통위, 개보위 등 관련 기관
- **고객 통지**: 고객 정보 유출 시 고객 통지
- **언론 대응**: 필요시 언론 발표 및 대응

#### 위기 커뮤니케이션
- **메시지 일관성**: 모든 채널에서 일관된 메시지 전달
- **투명성**: 숨김없는 정확한 정보 제공
- **신속성**: 빠른 시간 내 대응 상황 공유
- **책임감**: 책임 인정 및 개선 의지 표명

## 5.4 업무 연속성 관리

### 5.4.1 업무 연속성 계획 (BCP)

#### BCP 개념
- **정의**: 재해나 중대한 사고 발생 시 핵심 업무의 연속성을 보장하기 위한 계획
- **목적**:
  - 인명 안전 보장
  - 핵심 업무 신속 복구
  - 고객 서비스 연속성
  - 재무적 손실 최소화
- **범위**: 자연재해, 사이버 공격, 시스템 장애, 팬데믹 등

#### BCP 구성 요소
1. **업무 영향 분석 (BIA: Business Impact Analysis)**:
   - 핵심 업무 프로세스 식별
   - 중단 시 영향도 분석
   - 목표 복구 시간 (RTO) 설정
   - 목표 복구 지점 (RPO) 설정

2. **위험 평가**:
   - 재해 시나리오 분석
   - 발생 가능성 및 영향도 평가
   - 리스크 우선순위 결정

3. **연속성 전략**:
   - 대안 업무 절차
   - 백업 시설 및 인력
   - 기술적 복구 방안
   - 공급업체 대안

4. **복구 계획**:
   - 단계별 복구 절차
   - 역할 및 책임
   - 연락처 및 의사소통
   - 테스트 및 유지보수

#### 핵심 지표
- **RTO (Recovery Time Objective)**: 목표 복구 시간
- **RPO (Recovery Point Objective)**: 목표 복구 지점
- **MTTR (Mean Time To Repair)**: 평균 복구 시간
- **MTBF (Mean Time Between Failures)**: 평균 고장 간격

### 5.4.2 재해 복구 계획 (DRP)

#### DRP 개념
- **정의**: IT 시스템과 데이터의 복구를 위한 기술적 계획
- **BCP와의 관계**: BCP의 IT 부분을 담당하는 하위 계획
- **목적**: IT 서비스의 신속한 복구 및 데이터 손실 최소화

#### 재해 복구 전략
1. **콜드 사이트 (Cold Site)**:
   - 빈 공간과 기본 인프라만 제공
   - 복구 시간 길고 비용 낮음
   - 며칠에서 몇 주 소요

2. **웜 사이트 (Warm Site)**:
   - 부분적 시스템과 데이터 준비
   - 중간 수준의 복구 시간과 비용
   - 몇 시간에서 며칠 소요

3. **핫 사이트 (Hot Site)**:
   - 완전한 시스템과 데이터 실시간 동기화
   - 빠른 복구 시간, 높은 비용
   - 즉시에서 몇 시간 소요

4. **클라우드 기반 복구**:
   - 클라우드 인프라 활용
   - 유연한 확장성
   - 비용 효율성

#### 데이터 백업 전략
- **풀 백업 (Full Backup)**: 전체 데이터 백업
- **증분 백업 (Incremental Backup)**: 변경된 부분만 백업
- **차등 백업 (Differential Backup)**: 마지막 풀 백업 이후 변경분
- **3-2-1 룰**: 3개 사본, 2개 매체, 1개 오프사이트

### 5.4.3 위기 관리

#### 위기 관리 단계
1. **예방 (Prevention)**:
   - 위기 요소 사전 식별
   - 예방 조치 실시
   - 모니터링 체계 구축

2. **준비 (Preparation)**:
   - 위기 대응팀 구성
   - 대응 계획 수립
   - 훈련 및 시뮬레이션

3. **대응 (Response)**:
   - 초기 대응
   - 피해 확산 방지
   - 이해관계자 커뮤니케이션

4. **복구 (Recovery)**:
   - 정상 상태 복구
   - 업무 재개
   - 추가 피해 방지

5. **학습 (Learning)**:
   - 사후 분석
   - 교훈 도출
   - 계획 개선

#### 위기 커뮤니케이션 전략
- **신속성**: 빠른 상황 전파
- **정확성**: 정확한 정보 전달
- **투명성**: 숨김없는 소통
- **일관성**: 메시지 통일
- **공감**: 이해관계자 입장 고려

## 5.5 정보보안 교육 및 인식

### 5.5.1 보안 인식 교육

#### 보안 교육의 중요성
- **인적 요소**: 가장 취약한 보안 링크
- **사회공학 대응**: 피싱, 스미싱 등 대응
- **정책 준수**: 보안 정책 이행 확보
- **보안 문화**: 조직 전체 보안 의식 제고

#### 교육 대상별 프로그램
- **신입사원**: 기본 보안 교육
- **일반 직원**: 정기 보안 교육
- **관리자**: 리더십 및 책임
- **IT 담당자**: 기술적 보안 교육
- **외부 협력사**: 보안 요구사항 교육

#### 교육 방법
- **집합 교육**: 강의실 교육
- **이러닝**: 온라인 교육
- **시뮬레이션**: 실습 기반 교육
- **워크샵**: 참여형 교육
- **캠페인**: 포스터, 이메일 등

### 5.5.2 보안 인식 측정

#### 측정 방법
- **테스트**: 보안 지식 평가
- **설문조사**: 인식 수준 조사
- **모의훈련**: 피싱 시뮬레이션
- **행동 관찰**: 실제 행동 모니터링

#### 성과 지표
- **교육 참여율**: 교육 이수자 비율
- **테스트 점수**: 평가 결과
- **사고 발생률**: 인적 오류로 인한 사고
- **신고율**: 의심스러운 활동 신고

### 5.5.3 보안 문화 구축

#### 보안 문화 요소
- **경영진 의지**: 최고경영진의 보안 의지
- **공유 가치**: 조직 구성원의 보안 가치관
- **행동 규범**: 일상적인 보안 행동
- **지속적 개선**: 보안 문화의 지속적 발전

#### 문화 구축 방안
- **롤모델**: 보안 모범 사례 공유
- **인센티브**: 보안 우수자 포상
- **참여**: 구성원 참여 기회 제공
- **소통**: 보안 이슈 공유 및 토론

## 5.6 컴플라이언스 및 감사

### 5.6.1 정보보안 감사

#### 감사 개념
- **정의**: 조직의 정보보안 상태를 객관적으로 평가하는 활동
- **목적**: 정책 준수 확인, 취약점 식별, 개선사항 도출
- **유형**: 내부감사, 외부감사, 제3자 감사

#### 감사 프로세스
1. **계획**: 감사 범위, 일정, 방법 결정
2. **준비**: 감사 기준, 체크리스트 준비
3. **실시**: 문서 검토, 면담, 현장 확인
4. **보고**: 감사 결과 및 권고사항 보고
5. **후속 조치**: 개선사항 이행 확인

#### 감사 영역
- **정책 및 절차**: 정책 수립 및 이행 상태
- **기술적 통제**: 보안 시스템 및 설정
- **물리적 보안**: 시설 및 장비 보안
- **인적 보안**: 교육, 인식, 접근 권한
- **사고 대응**: 사고 처리 및 복구

### 5.6.2 주요 컴플라이언스 요구사항

#### 개인정보보호법
- **개인정보 처리 원칙**: 적법성, 투명성, 목적 제한
- **개인정보 보호 조치**: 기술적, 관리적, 물리적 보호조치
- **개인정보 처리 위탁**: 위탁업체 관리 및 감독
- **개인정보 유출 신고**: 72시간 이내 신고 의무

#### 정보통신망법
- **개인정보 보호**: 개인정보 수집, 이용, 제공 제한
- **정보보호 관리체계**: ISMS 인증 의무
- **침해신고센터**: 침해사고 신고 체계
- **과태료**: 위반 시 과태료 부과

#### 금융권 보안 규제
- **전자금융감독규정**: 금융기관 정보보안 요구사항
- **금융보안원 가이드라인**: 금융 정보보안 가이드
- **개인신용정보보호법**: 신용정보 보호 요구사항

#### 국제 표준 및 인증
- **ISO/IEC 27001**: 정보보안 관리체계 국제 표준
- **SOC 2**: 서비스 조직 통제 보고서
- **PCI DSS**: 신용카드 데이터 보안 표준
- **GDPR**: EU 개인정보보호 규정

### 5.6.3 ISMS 인증

#### ISMS-P (정보보호 및 개인정보보호 관리체계)
- **인증 대상**: 일정 규모 이상의 정보통신서비스 제공자
- **인증 기준**:
  - 관리체계 기반 마련 (4개 항목)
  - 관리체계 운영 (6개 항목)
  - 보호대책 요구사항 (104개 통제항목)
- **인증 절차**:
  1. 인증신청
  2. 문서심사
  3. 현장심사
  4. 인증위원회 심의
  5. 인증서 발급

#### ISO/IEC 27001 인증
- **국제 표준**: 전 세계적으로 인정받는 표준
- **인증 기준**:
  - PDCA 사이클 적용
  - 133개 보안 통제 (Annex A)
  - 위험 기반 접근법
- **인증 절차**:
  1. 갭 분석
  2. ISMS 구축
  3. 내부심사
  4. 1차 심사 (문서심사)
  5. 2차 심사 (현장심사)
  6. 인증서 발급

이상으로 정보보안 관리 영역의 핵심 내용을 정리했습니다. 총 5개 챕터에 걸쳐 정보보안기사 시험에 출제되는 주요 개념들을 체계적으로 정리했습니다.