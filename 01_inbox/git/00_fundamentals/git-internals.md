---
title: git-internals
tags: [git, internals, architecture, objects]
aliases: [Git 인턴십, Git 내부 구조, Git 원리]
date modified: 2025-12-18 14:00:00 +09:00
date created: 2025-12-18 14:00:00 +09:00
---

## Git Internals: 데이터로 보는 Git의 본질

Git은 단순한 버전 관리 도구가 아니라, **"콘텐츠 주소지정 파일 시스템 (Content-Addressable File System)"** 위에 구현된 버전 관리 도구입니다. 이 원리를 이해하면 Git의 모든 명령어가 왜 그렇게 동작하는지 명확해집니다.

### 💡 Why it matters (Context)

- **무결성 보장**: 파일 내용이 1비트만 바뀌어도 해시값이 달라지므로 데이터 손상을 즉시 감지합니다.
- **효율적인 저장**: 동일한 내용의 파일은 물리적으로 단 하나만 저장합니다.
- **불변성 (Immutability)**: 한번 저장된 오브젝트는 바뀌지 않습니다. 변경은 항상 '새로운 오브젝트 생성'을 의미합니다.

---

### 🏢 실무 사례

- **대규모 모노레포 관리**: Git의 인덱싱 방식을 이해하면 수백만 개의 파일이 있는 레포지토리에서의 성능 최적화(Sparse Checkout 등)를 이해할 수 있습니다.
- **커스텀 도구 개발**: Git Hook이나 자동화 스크립트 작성 시 `.git` 내부 구조를 알면 훨씬 강력한 도구를 만들 수 있습니다.
- **데이터 복구**: `git reflog`조차 통하지 않을 때, `git fsck`와 오브젝트 파일을 직접 뒤져 유실된 코드를 살려낼 수 있습니다.

---

## 🏗️ Git Object 모델 (4개 핵심 객체)

Git은 모든 데이터를 `.git/objects` 디렉토리에 SHA-1 해시를 이름으로 하는 파일로 저장합니다.

### 1. Blob (Binary Large Object)
- **역할**: 파일의 **내용**만 저장합니다.
- **특징**: 파일명, 권한 정보는 포함하지 않습니다. 오직 데이터 그 자체입니다.

### 2. Tree (트리)
- **역할**: 디렉토리 구조를 저장합니다.
- **내용**: Blob이나 다른 Tree의 해시값, 파일명, 모드(권한)를 담고 있습니다.
- **비유**: 파일 시스템의 '폴더'와 같습니다.

### 3. Commit (커밋)
- **역할**: 프로젝트의 특정 시점(스냅샷)을 저장합니다.
- **내용**: 루트 Tree의 해시값, 부모 커밋의 해시값, 작성자, 메시지.

### 4. Tag (태그)
- **역할**: 특정 커밋에 이름을 붙입니다. (v1.0.0 등)

---

## 📁 .git 디렉토리 파헤치기

| 폴더/파일 | 설명 |
|:---|:---|
| **`objects/`** | 모든 데이터(Blob, Tree, Commit)가 저장되는 핵심 데이터베이스. |
| **`refs/`** | 브랜치(`heads`)와 태그(`tags`)가 가리키는 커밋 해시값이 들어있는 포인터 집합. |
| **`HEAD`** | 현재 체크아웃된 브랜치나 커밋을 가리키는 파일. (보통 `ref: refs/heads/main`) |
| **`index`** | 스테이징 영역(Staging Area) 정보가 담긴 이진 파일. |
| **`config`** | 이 저장소만 적용되는 설정 정보. |

---

## 🛠️ 작동 원리 시뮬레이션

파일 `a.txt`를 수정하고 커밋하면 어떤 일이 벌어질까요?

1. **Hash 생성**: 파일 내용을 SHA-1으로 해싱하여 고유 ID를 만듭니다.
2. **Blob 저장**: `.git/objects`에 내용을 저장합니다.
3. **Index 업데이트**: 스테이징 영역에 이 해시값을 등록합니다.
4. **Tree 생성**: 현재 프로젝트 구조를 나타내는 트리 오브젝트를 만듭니다.
5. **Commit 생성**: 작성자 정보와 트리 해시를 묶어 커밋 오브젝트를 만들고, `main` 브랜치 포인터를 이 새 커밋으로 옮깁니다.

---

## 🚨 흔한 실수 (Common Mistakes)

1. **대용량 바이너리 파일 커밋** ❌
   - Git은 스냅샷 방식이므로, 1GB 파일을 10번 수정하고 커밋하면 레포지토리 크기가 순식간에 10GB 가까이 늘어날 수 있습니다. (LFS 사용 권장)
2. **`.git` 폴더 임의 수정** ❌
   - 특히 `index`나 `objects` 내부 파일을 직접 수정하면 데이터 무결성이 깨져 레포지토리가 망가질 수 있습니다.
3. **민감 정보(Password, Key) 커밋**
   - 커밋 후 파일을 지워도, Git 히스토리(Blob 오브젝트)에는 영원히 남습니다. 이 경우 `git filter-repo`나 `BFG Repo-Cleaner`로 오브젝트를 완전히 삭제해야 합니다.

---

### 📚 연결 문서
- [[00_fundamentals/basic-concepts|Git 기본 개념]] - 원리를 바탕으로 한 영역 이해
- [[02_advanced/troubleshooting|트러블슈팅]] - 원리를 이용한 데이터 복구
- [[01_strategies/commit-messages|커밋 메시지]] - 의미 있는 스냅샷 만들기
