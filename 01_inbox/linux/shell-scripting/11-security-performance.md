---
title: 11. 보안, 성능, 포터빌리티
tags: [linux, shell, security, performance, portability]
---

# 11. 보안, 성능, 포터빌리티

현대적인 스크립팅 환경에서 보안 사고를 방지하고 최적의 성능과 이식성을 확보하는 전략을 다룹니다.

## 1. 보안 베스트 프랙티스
| 항목 | 보안 수칙 | 설명 |
| :--- | :--- | :--- |
| **입력 검증** | **화이트리스트 (Whitelist) 검사** | 정규식을 통해 허용된 문자열만 처리 |
| **임시 파일 생성** | **`mktemp` 사용** | 예측 가능한 파일명을 피하고 안전하게 생성 |
| **권한 관리** | **`umask 077` 설정** | 생성된 파일의 기본 권한을 엄격하게 제한 |
| **경로 지정** | **절대경로 및 `--` 사용** | 상대경로의 위험을 피하고 파일명 오해 방지 |
| **환경 변수** | **`PATH` 재정의** | 스크립트 실행 시 신뢰할 수 있는 경로를 명시 |

## 2. 포터빌리티 (GNU vs BSD)
리눅스(GNU)와 macOS(BSD) 환경에서 차이가 발생하는 주요 포인트입니다.

| 도구 / 기능 | GNU (Linux) | BSD (macOS) | 권장 대안 |
| :--- | :--- | :--- | :--- |
| **sed -i** | `-i[SUFFIX]` (공백 없음) | `-i ''` (공백 필수) | 공백 없는 `-i.bak` 사용 |
| **readlink** | `readlink -f` | `-f` 옵션 없음 | `perl` 또는 `python` 활용 |
| **date** | `date -d '...` | `date -v '...` | `perl` 시용 또는 GNU 설치 |
| **timeout** | `timeout` 명령 존재 | 미지원 | Perl/Python 기반 스크립트 |

## 3. 성능 최적화 (Efficiency)
| 전략 | 방법 | 효과 |
| :--- | :--- | :--- |
| **프로세스 최소화** | 내장 연산(Substitution) 사용 | 서브셸(fork) 생성 억제 |
| **대량 데이터 읽기** | `mapfile` / `readarray` | 루프 기반 `read`보다 압도적 속도 |
| **정렬/검색** | `LC_ALL=C` 설정 | 로케일 계산 생략으로 속도 향상 |
| **병렬 처리** | `xargs -P` / `GNU parallel` | 멀티코어 리소스 활용 |

## 4. 안전 옵션의 함정과 보완
| 옵션 (set) | 함정 (Pitfall) | 보완책 |
| :--- | :--- | :--- |
| **`-e` (errexit)** | `if`, `while`, `||` 조건에서 무시됨 | 실패가 중요한 곳은 명시적 `|| exit` |
| **`-u` (nounset)** | 옵션 변수가 없을 때 중단됨 | `${VAR:-default}` 패턴으로 가드 |
| **명령 치환** | 서브셸 실패를 부모가 못 잡을 수 있음 | `if ! output=$(cmd); then ...` 패턴 사용 |

---
## 🔗 연결 문서
- [[10-debugging-style]] - 디버깅 및 스타일 가이드
- [[12-recipes]] - 실전 레시피 및 체크리스트
