---
title: 05-functions
tags: [bash, functions, linux, shell]
aliases: []
date modified: 2025-12-28 20:54:57 +09:00
date created: 2025-12-28 20:44:39 +09:00
---

## 05. 함수, 모듈화, 재사용

코드의 재사용성을 높이기 위한 함수 정의 방법과 파일 분리를 통한 모듈화 전략을 정리합니다.

### 1. 함수 선언 방식

| 방식                   | 문법                    | 특징                  |
| :------------------- | :-------------------- | :------------------ |
| **임의 명칭 (Standard)** | `name() { … }`        | POSIX 표준 호환 방식 (권장) |
| **Keyword 방식**       | `function name { … }` | Bash 전용, 소괄호 생략 가능  |

### 2. 함수 인자 및 반환 처리

| 항목                 | 처리 방법                          | 특징                       |
| :----------------- | :----------------------------- | :----------------------- |
| **인자 (Arguments)** | `$1`, `$2`, `$@` 등을 함수 내부에서 사용 | 함수용 지역 변수 스코프 적용         |
| **지역 변수**          | `local var="value"`            | 함수 외부 변수와의 충돌 방지         |
| **종료 상태 (Status)** | `return N` (0-255)             | 함수의 성공/실패 여부를 호출부에 전달    |
| **데이터 반환**         | `echo "result"`                | 표준 출력(stdout)을 사용하여 값 전달 |

### 3. 모듈화 및 로딩

- **외부 파일 로딩**: `source file.sh` 또는 `. file.sh` 를 사용하여 다른 파일의 함수를 현재 환경으로 로드합니다.
- **로딩 확인**: `[ -r "$lib" ] || exit 1` 패턴으로 라이브러리 파일 존재 여부를 체크합니다.

### 4. 옵션 파싱 (getopts)

함수나 스크립트에서 옵션을 처리할 때 사용하는 표준 방식입니다.

|     구성 요소      | 설명                                         |
| :------------: | :----------------------------------------- |
|   **`opt`**    | 현재 처리 중인 옵션 문자 (예: `f`, `v`)               |
|  **`OPTARG`**  | 옵션에 딸린 인자값 (예: `-f filename` 의 `filename`) |
|  **`OPTIND`**  | 다음 처리할 옵션의 인덱스 (함수 내 로컬 선언 필수)             |
| **`:` 또는 `?`** | 오류(인자 누락, 잘못된 옵션) 처리 시 사용                  |

### 5. 로깅 및 에러 헬퍼

| 권장 함수명     | 역할            | 특징                  |
| :--------- | :------------ | :------------------ |
| `log_info` | 일반 정보 출력      | stdout 사용           |
| `log_err`  | 에러 정보 출력      | **stderr (>&2)** 사용 |
| `abort`    | 오류 출력 후 즉시 종료 | `exit 1` 동반         |

---

### 🔗 연결 문서

- [[04-control-flow]] - 제어 구조 탐색
- [[06-io-redirection]] - 입출력 및 리디렉션
