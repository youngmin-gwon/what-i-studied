---
title: 02-시스템-보안
tags: []
aliases: []
date modified: 2026-02-25 15:13:55 +09:00
date created: 2025-12-16 20:25:15 +09:00
---

## 2. 시스템 보안

### 2.1 운영체제 보안

#### 2.1.1 운영체제 보안 개요

##### 운영체제의 역할과 보안 중요성
- **운영체제**: 하드웨어와 응용프로그램 사이의 인터페이스 역할
- **보안 기능**: 시스템 자원에 대한 접근 제어, 프로세스 격리, 메모리 보호
- **보안 위협**: 권한 에스컬레이션, 버퍼 오버플로, 루트킷, 악성코드 감염

##### 운영체제 보안 기본 원칙
1. **최소 권한 원칙**: 작업 수행에 필요한 최소한의 권한만 부여
2. **심층 방어**: 다중 보안 계층으로 시스템 보호
3. **완전한 중재**: 모든 접근 시도에 대한 검증
4. **보안 설계**: 처음부터 보안을 고려한 설계
5. **개방 설계**: 보안 메커니즘의 공개를 통한 검증
6. **권한 분리**: 서로 다른 권한의 분리 운영
7. **최소 공통 메커니즘**: 공유 메커니즘 최소화

#### 2.1.2 Windows 보안 상세

##### Windows 보안 아키텍처
- **Security Reference Monitor (SRM)**: 핵심 보안 엔진
- **Local Security Authority (LSA)**: 인증 정책 관리
- **Security Account Manager (SAM)**: 로컬 계정 데이터베이스
- **Active Directory**: 도메인 환경의 중앙 집중식 인증

##### Windows 인증 메커니즘

###### 로컬 인증 (SAM 기반)

- **SAM 데이터베이스**: `%SystemRoot%\System32\config\SAM`
- **암호 해시**: NTLM 해시 (MD4 기반)
- **LM 해시**: 레거시 인증 (매우 취약, 비활성화 권장)
- **보안 강화**:
  ```
  Computer Configuration > Windows Settings > Security Settings > Account Policies
  - Password Policy: 복잡성 요구사항 설정
  - Account Lockout Policy: 계정 잠금 정책
  ```

###### Active Directory 인증

- **도메인 컨트롤러**: 중앙 집중식 인증 서버
- **Kerberos v5**: 기본 인증 프로토콜
- **LDAP**: 디렉토리 조회 프로토콜
- **Group Policy**: 도메인 전체 보안 정책 적용

##### Kerberos 인증 과정 상세

1. **AS-REQ**: 클라이언트가 AS(Authentication Server)에 TGT 요청
2. **AS-REP**: AS 가 TGT(Ticket Granting Ticket) 발급
3. **TGS-REQ**: 클라이언트가 TGS(Ticket Granting Server)에 서비스 티켓 요청
4. **TGS-REP**: TGS 가 서비스 티켓 발급
5. **AP-REQ**: 클라이언트가 서비스에 티켓 제시
6. **AP-REP**: 서비스가 인증 완료 응답

##### Windows 파일 시스템 보안

###### NTFS 고급 보안 기능
- **ACL (Access Control List)**: 각 객체별 세부 권한 설정
- **DACL (Discretionary ACL)**: 소유자가 설정하는 접근 권한
- **SACL (System ACL)**: 감사 설정
- **SID (Security Identifier)**: 고유 보안 식별자

###### NTFS 권한 상세

```
기본 권한:
- Full Control: 모든 권한 (삭제, 소유권 변경 포함)
- Modify: 파일 수정, 삭제 (소유권 변경 제외)
- Read & Execute: 파일 읽기 및 실행
- Read: 파일 내용 읽기만 가능
- Write: 파일 쓰기 (기존 파일 덮어쓰기 불가)

고급 권한:
- Traverse Folder/Execute File
- List Folder/Read Data
- Read Attributes
- Read Extended Attributes
- Create Files/Write Data
- Create Folders/Append Data
- Write Attributes
- Write Extended Attributes
- Delete Subfolders and Files
- Delete
- Read Permissions
- Change Permissions
- Take Ownership
```

###### EFS (Encrypting File System)

- **기능**: 파일 수준 투명 암호화
- **알고리즘**: AES-256 (Windows Vista 이후)
- **키 관리**: 사용자 인증서와 연동
- **복구**: DRA (Data Recovery Agent) 설정 가능
- **주의사항**: 파일 이동 시 암호화 해제 가능성

##### Windows 계정 관리

###### 기본 계정 상세

```
로컬 계정:
- Administrator (RID 500): 시스템 최고 권한
- Guest (RID 501): 임시 사용자 (기본 비활성화)
- DefaultAccount: Windows 10 이후 추가된 기본 계정
- WDAGUtilityAccount: Windows Defender Application Guard용

서비스 계정:
- LocalSystem: 가장 높은 권한 (S-1-5-18)
- LocalService: 제한된 권한 (S-1-5-19)
- NetworkService: 네트워크 자격 증명 (S-1-5-20)
```

###### User Account Control (UAC)

- **목적**: 관리자 권한 요청의 명시적 승인
- **동작 원리**:
  - 일반 사용자 토큰과 관리자 토큰 분리
  - 관리자 작업 시 승격 프롬프트 표시
- **바이패스 기법**: DLL Hijacking, COM Elevation Moniker 등
- **보안 설정**:
  ```
  Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options
  - User Account Control: Admin Approval Mode 설정
  ```

##### Windows 보안 도구 및 기능

###### Windows Defender

- **실시간 보호**: 파일 시스템, 이메일, 웹 실시간 스캔
- **클라우드 보호**: Microsoft 클라우드 위협 인텔리전스 활용
- **제어된 폴더 액세스**: 랜섬웨어 방지
- **공격 표면 축소**: 스크립트, Office 매크로 등 제한

###### BitLocker

- **전체 디스크 암호화**: AES-128/256 암호화
- **TPM (Trusted Platform Module)**: 하드웨어 보안 칩 활용
- **인증 방법**: TPM, PIN, USB 키, 암호
- **복구 키**: 암호 분실 시 복구 메커니즘

###### Event Logging

- **Windows Event Log**: 시스템, 보안, 응용프로그램 로그
- **주요 보안 이벤트**:
  ```
  4624: 계정 로그온 성공
  4625: 계정 로그온 실패
  4648: 명시적 자격 증명 로그온
  4720: 사용자 계정 생성
  4728: 보안 그룹에 멤버 추가
  4732: 로컬 그룹에 멤버 추가
  ```

#### 2.1.3 Linux/Unix 보안 상세

##### Linux 보안 아키텍처

- **Kernel Space vs User Space**: 권한 분리 구조
- **System Call Interface**: 커널 서비스 접근점
- **VFS (Virtual File System)**: 파일 시스템 추상화 계층
- **Linux Security Modules (LSM)**: 플러그인형 보안 프레임워크

##### Linux 사용자 및 그룹 관리

###### 사용자 계정 구조

```bash
# /etc/passwd 형식
username:password:UID:GID:GECOS:home_directory:shell

# 예시
root:x:0:0:root:/root:/bin/bash
user1:x:1000:1000:User Name,,,:/home/user1:/bin/bash

# 필드 설명
- username: 사용자 이름
- password: 'x' (실제 암호는 /etc/shadow)
- UID: 사용자 ID (0은 root)
- GID: 기본 그룹 ID
- GECOS: 사용자 정보 (이름, 연락처 등)
- home_directory: 홈 디렉토리 경로
- shell: 로그인 셸
```

###### 암호 관리 (/etc/shadow)

```bash
# /etc/shadow 형식
username:encrypted_password:last_change:min_age:max_age:warning:inactive:expire:reserved

# 예시
root:$6$salt$hash:18000:0:99999:7:::
user1:$6$salt$hash:18000:0:90:7:30:18365:

# 암호 해시 형식
$1$ - MD5 (비권장)
$5$ - SHA-256
$6$ - SHA-512 (권장)
$y$ - yescrypt
```

##### Linux 파일 시스템 보안

###### 전통적 권한 시스템
```bash
# 권한 표현 방법
-rwxrwxrwx
|   |   |
|   |   └── Others (all users)
|   └────── Group
└────────── Owner

# 특수 권한
SUID (4xxx): 소유자 권한으로 실행
SGID (2xxx): 그룹 권한으로 실행 (파일), 그룹 상속 (디렉토리)
Sticky Bit (1xxx): 소유자만 삭제 가능

# 예시
4755: SUID 설정된 실행 파일 (passwd 명령 등)
2755: SGID 설정된 실행 파일
1777: Sticky Bit 설정된 디렉토리 (/tmp)
```

###### 확장 속성 (Extended Attributes)
```bash
# 확장 속성 확인
getfattr -d filename

# 불변 속성 설정 (수정 방지)
chattr +i filename

# append-only 설정
chattr +a filename

# 압축 속성
chattr +c filename
```

##### 고급 Linux 보안 메커니즘

###### SELinux (Security-Enhanced Linux)

- **강제 접근 통제 (MAC)**: 관리자도 정책에 따라 제한
- **정책 종류**:
  - Targeted: 특정 서비스만 제한 (기본값)
  - Strict: 모든 프로세스 제한
  - MLS: Multi-Level Security
- **동작 모드**:
  ```bash
  # 현재 모드 확인
  getenforce

  # 모드 변경
  setenforce 0  # Permissive
  setenforce 1  # Enforcing

  # 영구 설정
  /etc/selinux/config
  ```

- **컨텍스트 구조**:
  ```
  user:role:type:level
  unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
  ```

###### AppArmor

- **경로 기반 접근 제어**: 파일 경로를 이용한 제어
- **프로파일 모드**:
  - Enforce: 정책 강제 적용
  - Complain: 로깅만 수행
- **프로파일 위치**: `/etc/apparmor.d/`

###### Linux Capabilities

```bash
# 프로세스별 세분화된 권한
CAP_NET_ADMIN: 네트워크 관리
CAP_SYS_ADMIN: 시스템 관리
CAP_DAC_OVERRIDE: 파일 권한 무시
CAP_SETUID: UID 변경

# 실행 파일에 capability 설정
setcap cap_net_bind_service+ep /usr/bin/apache2

# capability 확인
getcap /usr/bin/apache2
```

##### Linux 네트워크 보안

###### iptables/netfilter

```bash
# 기본 체인
INPUT: 들어오는 패킷
OUTPUT: 나가는 패킷
FORWARD: 통과하는 패킷

# 기본 설정 예시
# 모든 트래픽 차단 후 선별 허용
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# SSH 접속 허용
iptables -A INPUT -p tcp --dport 22 -j ACCEPT

# 기존 연결 허용
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# 로컬 통신 허용
iptables -A INPUT -i lo -j ACCEPT
```

###### 최신 방화벽 도구

```bash
# firewalld (CentOS/RHEL)
firewall-cmd --list-all
firewall-cmd --add-service=ssh --permanent
firewall-cmd --reload

# ufw (Ubuntu)
ufw enable
ufw allow ssh
ufw allow 80/tcp
```

##### Linux 감사 시스템

###### auditd

```bash
# 설정 파일
/etc/audit/auditd.conf
/etc/audit/rules.d/audit.rules

# 규칙 예시
# 파일 접근 감시
-w /etc/passwd -p wa -k password_changes

# 시스템 콜 감시
-a always,exit -S open -S openat -k file_access

# 권한 변경 감시
-a always,exit -S chmod -S fchmod -S fchmodat -k perm_mod
```

#### 2.1.4 macOS 보안

##### macOS 보안 아키텍처

- **XNU 커널**: Darwin 운영체제 기반
- **System Integrity Protection (SIP)**: 시스템 파일 보호
- **Secure Boot**: 부팅 과정 무결성 검증
- **T2/Apple Silicon**: 하드웨어 보안 칩

##### macOS 고유 보안 기능

###### Gatekeeper

- **목적**: 신뢰할 수 없는 소프트웨어 실행 방지
- **정책**:
  - App Store and identified developers
  - App Store only
  - Anywhere (비권장)

###### XProtect

- **내장 안티바이러스**: 백그라운드 실시간 보호
- **YARA 규칙**: 시그니처 기반 탐지
- **자동 업데이트**: Apple 이 중앙 관리

#### 2.1.5 운영체제 취약점 관리와 패치 관리

##### 취약점 생명주기

1. **발견**: 연구자, 개발자, 공격자에 의한 발견
2. **보고**: 벤더 또는 취약점 데이터베이스 보고
3. **분석**: 영향도 및 위험도 평가
4. **패치 개발**: 벤더의 수정 사항 개발
5. **패치 배포**: 공식 패치 릴리즈
6. **패치 적용**: 시스템 관리자의 패치 설치
7. **검증**: 패치 적용 효과 확인

##### 패치 관리 베스트 프랙티스

###### 패치 관리 프로세스

1. **인벤토리 관리**: 모든 시스템과 소프트웨어 목록 유지
2. **취약점 모니터링**: CVE, 벤더 어드바이저리 추적
3. **위험도 평가**: CVSS 점수 및 비즈니스 영향도 고려
4. **테스트 환경**: 프로덕션 적용 전 테스트
5. **롤백 계획**: 패치 실패 시 복구 방안
6. **스케줄링**: 비즈니스 영향 최소화 시간 선택

###### 자동화 도구

```bash
# Windows
WSUS (Windows Server Update Services)
SCCM (System Center Configuration Manager)
Windows Update for Business

# Linux
yum-cron (CentOS/RHEL)
unattended-upgrades (Ubuntu/Debian)
Spacewalk (Red Hat Satellite)

# 크로스 플랫폼
Ansible
Puppet
Chef
```

##### 보안 강화 (Hardening) 가이드

###### CIS (Center for Internet Security) Benchmarks

```bash
# Linux 강화 예시
# 1. 불필요한 서비스 비활성화
systemctl disable telnet
systemctl disable rsh
systemctl disable nfs

# 2. 네트워크 매개변수 설정
echo 'net.ipv4.ip_forward = 0' >> /etc/sysctl.conf
echo 'net.ipv4.conf.all.send_redirects = 0' >> /etc/sysctl.conf
echo 'net.ipv4.conf.all.accept_redirects = 0' >> /etc/sysctl.conf

# 3. 파일 시스템 보안
mount -o nodev,nosuid,noexec /tmp
mount -o nodev,nosuid,noexec /var/tmp

# 4. 로그인 배너 설정
echo 'Authorized users only' > /etc/issue
echo 'Authorized users only' > /etc/issue.net
```

###### Windows 강화 예시

```powershell
# 1. 불필요한 서비스 비활성화
Set-Service -Name "Telnet" -StartupType Disabled
Set-Service -Name "RemoteRegistry" -StartupType Disabled

# 2. 레지스트리 보안 설정
# 자동 로그온 비활성화
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "AutoAdminLogon" -Value "0"

# 3. PowerShell 실행 정책
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned

# 4. Windows 기능 비활성화
Disable-WindowsOptionalFeature -Online -FeatureName "TelnetClient"
Disable-WindowsOptionalFeature -Online -FeatureName "TFTP"
```

##### 무결성 모니터링

###### AIDE (Advanced Intrusion Detection Environment)

```bash
# 설정 파일: /etc/aide.conf
# 데이터베이스 초기화
aide --init

# 무결성 검사
aide --check

# 규칙 예시
/bin    p+i+n+u+g+s+b+m+c+md5+sha1
/sbin   p+i+n+u+g+s+b+m+c+md5+sha1
/etc    p+i+n+u+g+s+b+m+c+md5+sha1
```

###### Tripwire

```bash
# 정책 파일 생성
twadmin --create-polfile /etc/tripwire/twpol.txt

# 데이터베이스 초기화
tripwire --init

# 무결성 검사
tripwire --check
```

##### 컨테이너 보안 고려사항

###### Docker 보안

```bash
# 1. 비특권 사용자로 실행
docker run --user 1000:1000 myapp

# 2. 읽기 전용 루트 파일 시스템
docker run --read-only myapp

# 3. 불필요한 capability 제거
docker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE myapp

# 4. 리소스 제한
docker run --memory=128m --cpus=0.5 myapp

# 5. 보안 프로파일 적용
docker run --security-opt apparmor=myprofile myapp
```

### 2.2 악성코드

#### 2.2.1 악성코드 개요와 분류

##### 악성코드 정의와 발전사

- **Malware**: Malicious Software 의 줄임말
- **목적**: 시스템 손상, 정보 탈취, 금전적 이득, 정치적 목적
- **발전 과정**:
  - 1970 년대: Creeper (최초의 컴퓨터 웜)
  - 1980 년대: Brain (최초의 PC 바이러스)
  - 1990 년대: 매크로 바이러스 등장
  - 2000 년대: 인터넷 웜 대유행 (Conficker, Slammer)
  - 2010 년대: APT 및 표적형 공격
  - 2020 년대: AI 기반 공격, 랜섬웨어 산업화

##### 악성코드 분류 체계

###### 전파 방식에 따른 분류

**바이러스 (Virus)**
- **정의**: 다른 프로그램에 기생하여 자기복제하는 코드
- **전파 조건**: 숙주 프로그램 실행 시
- **구조**:
  ```
  [원본 프로그램 코드]
  [바이러스 코드]
  [감염된 프로그램 코드]
  ```
- **세부 유형**:
  - **부트 섹터 바이러스**: MBR/VBR 감염 (Michelangelo, Stoned)
  - **파일 감염 바이러스**: EXE/COM 파일 감염 (Jerusalem, CIH)
  - **매크로 바이러스**: Office 문서 매크로 감염 (Melissa, ILOVEYOU)
  - **다형성 바이러스**: 실행시마다 코드 변화 (Polymorphic Engine)
  - **메타모르픽 바이러스**: 구조 자체를 변경 (Metamorphic Engine)

**웜 (Worm)**
- **정의**: 독립적으로 실행되며 네트워크를 통해 자기복제
- **전파 방법**:
  - 이메일 첨부파일 (ILOVEYOU, Melissa)
  - 네트워크 취약점 (Conficker, Slammer)
  - USB/이동식 매체 (Stuxnet, Conficker)
  - P2P 네트워크 (Storm Worm)
- **유명 사례**:
  ```
  Morris Worm (1988): 인터넷 초기 대규모 감염
  Code Red (2001): IIS 웹서버 Buffer Overflow 취약점
  SQL Slammer (2003): MS-SQL 서버 취약점, 15분만에 전세계 확산
  Conficker (2008): Windows 취약점 + USB + 네트워크 공유
  ```

###### 숨김 방식에 따른 분류

**트로이목마 (Trojan Horse)**
- **정의**: 유용한 프로그램으로 위장한 악성코드
- **동작 방식**: 사용자가 직접 실행
- **주요 유형**:
  - **백도어 트로이**: 원격 접근 권한 제공 (NetBus, BackOrifice)
  - **정보 탈취 트로이**: 민감 정보 수집 (Zeus, SpyEye)
  - **프록시 트로이**: 봇넷 구성원으로 활용
  - **다운로더 트로이**: 추가 악성코드 다운로드
  - **FakeAV 트로이**: 가짜 백신으로 위장

**루트킷 (Rootkit)**
- **정의**: 시스템에 은밀히 상주하며 존재를 숨기는 도구
- **은폐 기법**:
  - 파일/프로세스 목록에서 제외
  - 네트워크 연결 숨김
  - 레지스트리 키 은폐
  - API 후킹을 통한 시스템 호출 조작
- **유형별 분류**:
  ```
  User-mode Rootkit:
  - 사용자 레벨에서 동작
  - API 후킹 기법 사용
  - 탐지 상대적 용이

  Kernel-mode Rootkit:
  - 커널 레벨에서 동작
  - SSDT (System Service Descriptor Table) 후킹
  - 탐지 매우 어려움

  Bootkit:
  - 부팅 과정에서 로드
  - MBR/VBR 감염
  - OS 로드 이전에 활성화

  Hypervisor Rootkit:
  - 가상화 계층에서 동작
  - OS보다 낮은 레벨
  - Blue Pill, SubVirt
  ```

###### 목적에 따른 분류

**랜섬웨어 (Ransomware)**
- **발전 과정**:
  - 1989: AIDS Trojan (최초의 랜섬웨어)
  - 2005-2012: 초기 랜섬웨어 (Archiveus, Gpcode)
  - 2013-2016: CryptoLocker 계열 (RSA 암호화 도입)
  - 2017- 현재: WannaCry, 산업화된 RaaS
- **암호화 방식**:
  ```
  Symmetric Encryption (초기):
  - AES로 파일 암호화
  - 키를 로컬에 저장 (복구 가능성)

  Asymmetric Encryption (현재):
  - RSA 공개키로 AES 키 암호화
  - 개인키는 공격자만 보유
  - 복구 거의 불가능
  ```
- **주요 계열**:
  - **CryptoLocker 계열**: CryptoLocker, CryptoWall, TeslaCrypt
  - **Locky**: 매크로 문서를 통한 감염
  - **WannaCry**: EternalBlue 취약점 활용 웜형 랜섬웨어
  - **Petya/NotPetya**: MBR 암호화 + 파일 암호화
  - **Ryuk**: 표적형 공격, 높은 몸값 요구

**스파이웨어 (Spyware)**
- **정보 수집 유형**:
  ```
  키로거 (Keylogger):
  - 키보드 입력 기록
  - 하드웨어/소프트웨어 방식
  - 암호, 신용카드 정보 수집

  스크린 캡처:
  - 화면 스크린샷 주기적 촬영
  - 가상키보드 입력도 수집

  웹캠/마이크 스파이:
  - 카메라/마이크 무단 사용
  - 개인 사생활 침해

  파일 수집기:
  - 특정 확장자 파일 탈취
  - 문서, 이미지, 동영상 등
  ```

**애드웨어 (Adware)**
- **광고 수익 모델**: 클릭당 지불 (PPC) 악용
- **침해 행위**:
  - 브라우저 홈페이지 변경
  - 검색 결과 조작
  - 팝업 광고 강제 표시
  - 사용자 브라우징 패턴 추적

###### 최신 악성코드 트렌드

**파일리스 악성코드 (Fileless Malware)**
- **특징**: 디스크에 파일 저장 없이 메모리에서만 동작
- **기법**:
  ```
  PowerShell 기반:
  - Windows PowerShell 악용
  - 스크립트 형태로 실행
  - 로깅 우회 기법

  WMI 기반:
  - Windows Management Instrumentation 활용
  - 이벤트 기반 지속성 확보

  DLL Injection:
  - 정상 프로세스에 악성 DLL 주입
  - Process Hollowing
  - Reflective DLL Loading
  ```

**AI/ML 기반 악성코드**
- **적대적 AI (Adversarial AI)**:
  - ML 기반 탐지 시스템 우회
  - 적대적 예제 (Adversarial Examples) 생성
- **AI 기반 변형**:
  - 자동화된 코드 변형
  - 탐지 패턴 학습 및 회피

#### 2.2.2 악성코드 분석 상세

##### 정적 분석 (Static Analysis)

###### 기본 정보 수집

```bash
# 파일 해시 계산
md5sum malware.exe
sha256sum malware.exe

# 파일 정보 확인
file malware.exe
exiftool malware.exe

# 문자열 추출
strings malware.exe | grep -E '(http|ftp|\.exe|\.dll)'

# PE 헤더 분석 (Windows)
objdump -p malware.exe
readpe malware.exe

# ELF 헤더 분석 (Linux)
readelf -h malware
objdump -p malware
```

###### PE (Portable Executable) 분석
```
PE 헤더 구조:
- DOS Header: MZ 시그니처
- PE Header: PE00 시그니처
- Section Headers: 코드, 데이터 섹션 정보
- Import Table: 사용하는 DLL 및 API
- Export Table: 제공하는 함수
- Resource Section: 리소스 (아이콘, 문자열 등)

의심스러운 지표:
- 비정상적 섹션 이름 (.upack, .aspack)
- 높은 엔트로피 (패킹/암호화)
- 의심스러운 API 호출
- 리소스 섹션의 실행 코드
```

###### 패킹 탐지 및 언패킹

```bash
# 패킹 탐지
upx -t malware.exe
peid malware.exe

# 언패킹
upx -d malware.exe
```

###### 디스어셈블리 분석

```bash
# 무료 도구
objdump -d malware
radare2 malware

# 상용 도구
IDA Pro, Ghidra, x64dbg
```

##### 동적 분석 (Dynamic Analysis)

###### 샌드박스 환경 구축

```
가상 머신 설정:
- VMware/VirtualBox 사용
- 스냅샷 기능 활용
- 네트워크 격리 설정
- 분석 도구 사전 설치

네트워크 환경:
- INetSim: 인터넷 서비스 시뮬레이션
- FakeNet-NG: 네트워크 트래픽 시뮬레이션
- Wireshark: 패킷 캡처 및 분석
```

###### 시스템 모니터링

```powershell
# 프로세스 모니터링
procmon.exe  # Windows Process Monitor
ps aux | watch -n 1  # Linux

# 파일 시스템 변화
fsutil behavior set EnableReceiveNotifications 0  # Windows
inotifywait -m -r /  # Linux

# 레지스트리 변화 (Windows)
regshot  # 레지스트리 비교 도구

# 네트워크 연결
netstat -an | findstr ESTABLISHED  # Windows
netstat -tuln  # Linux
```

###### 메모리 분석

```bash
# 메모리 덤프 생성
volatility -f memory.vmem imageinfo
volatility -f memory.vmem pslist
volatility -f memory.vmem netscan
volatility -f memory.vmem malfind

# 라이브 메모리 분석
winpmem (Windows)
LiME (Linux Memory Extractor)
```

##### 코드 분석 기법

###### API 분석

```
중요 API 함수군:
File Operations:
- CreateFile, ReadFile, WriteFile
- DeleteFile, MoveFile

Process/Thread:
- CreateProcess, CreateThread
- OpenProcess, TerminateProcess

Registry:
- RegOpenKey, RegSetValue
- RegDeleteKey, RegCloseKey

Network:
- socket, connect, send, recv
- InternetOpen, HttpOpenRequest

Cryptography:
- CryptAcquireContext
- CryptEncrypt, CryptDecrypt
```

###### 실행 흐름 분석

```
정적 분석:
- Control Flow Graph (CFG) 생성
- 함수 호출 관계 분석
- 조건문 및 반복문 패턴

동적 분석:
- 실행 추적 (Tracing)
- 브레이크포인트 설정
- API 호출 로깅
```

#### 2.2.3 안티바이러스 기술과 탐지 우회

##### 전통적 탐지 기법

###### 시그니처 기반 탐지

```
동작 원리:
1. 알려진 악성코드의 고유 패턴 추출
2. 바이너리 시그니처 데이터베이스 구축
3. 파일 스캔 시 패턴 매칭

한계:
- Zero-day 악성코드 탐지 불가
- 다형성/메타모르픽 악성코드 대응 어려움
- 시그니처 우회 기법 진화

시그니처 예시:
HEX: 4D 5A 90 00 03 00 00 00 04 00 00 00
YARA: rule win_trojan { strings: $hex = { 4D 5A 90 00 } condition: $hex }
```

###### 휴리스틱 분석

```
분석 기준:
- 의심스러운 API 호출 패턴
- 비정상적 파일 구조
- 패킹/암호화 의심
- 자기 수정 코드

예시 휴리스틱 룰:
- CreateFile + WriteFile + SetFileAttributes (파일 감염)
- RegOpenKey + RegSetValue (레지스트리 수정)
- socket + connect (네트워크 통신)
```

##### 현대적 탐지 기법

###### 행위 기반 탐지

```
모니터링 대상:
- 파일 시스템 변화
- 네트워크 통신 패턴
- 프로세스 생성/종료
- 레지스트리/설정 변경

행위 분석 엔진:
- Windows Defender ATP
- CrowdStrike Falcon
- Carbon Black
```

###### 머신러닝 기반 탐지

```
특징 추출:
- Static Features: PE 헤더, API 임포트, 문자열
- Dynamic Features: API 호출 시퀀스, 네트워크 패턴

알고리즘:
- Random Forest
- Support Vector Machine
- Neural Networks
- Deep Learning (CNN, RNN)
```

###### 클라우드 기반 분석

```
장점:
- 실시간 위협 인텔리전스
- 대용량 데이터 처리
- 집단 지능 활용

주요 서비스:
- VirusTotal
- Hybrid Analysis
- Cuckoo Sandbox
- Joe Sandbox
```

##### 탐지 우회 기법

###### 패킹 (Packing)

```bash
# UPX 패킹
upx malware.exe

# 고급 패커
Themida, VMProtect, Armadillo

# 커스텀 패커 개발
- XOR 인코딩
- Base64 인코딩
- AES 암호화
```

###### 코드 난독화

```
기법:
- 함수명/변수명 무의미화
- 제어 흐름 복잡화
- Dead Code 삽입
- API 동적 로딩

도구:
- Obfuscator-LLVM
- ConfuserEx (.NET)
- JavaScript Obfuscator
```

###### 안티 - 디버깅 기법

```cpp
// IsDebuggerPresent API 체크
if (IsDebuggerPresent()) {
    ExitProcess(0);
}

// PEB 플래그 직접 검사
if (*(BYTE*)((BYTE*)GetPEB() + 2)) {
    ExitProcess(0);
}

// 타이밍 기반 검출
DWORD start = GetTickCount();
// 더미 연산
if (GetTickCount() - start > 100) {
    ExitProcess(0);  // 디버거 검출
}
```

###### 안티 -VM 기법

```cpp
// VMware 검출
HKEY hKey;
if (RegOpenKeyEx(HKEY_LOCAL_MACHINE,
    "SOFTWARE\\VMware, Inc.\\VMware Tools",
    0, KEY_QUERY_VALUE, &hKey) == ERROR_SUCCESS) {
    ExitProcess(0);
}

// VirtualBox 검출
if (GetModuleHandle("VBoxHook.dll")) {
    ExitProcess(0);
}

// 하드웨어 정보 검사
if (GetSystemMetrics(SM_CXSCREEN) < 1024 ||
    GetSystemMetrics(SM_CYSCREEN) < 768) {
    ExitProcess(0);  // VM 의심
}
```

#### 2.2.4 최신 악성코드 동향과 대응

##### APT (Advanced Persistent Threat) 악성코드

```plaintext
특징:
- 장기간 은밀한 잠복
- 표적 조직에 특화
- 다단계 공격 체인
- Living-off-the-land 기법

주요 APT 그룹:
- APT1 (Comment Crew): 중국, PLA 61398부대
- Lazarus: 북한, WannaCry, Sony 해킹
- Equation Group: 미국 NSA 연관
- Cozy Bear (APT29): 러시아 SVR
```

##### 공급망 공격 (Supply Chain Attack)

```plaintext
사례:
- SolarWinds (2020): Orion 소프트웨어 백도어
- CCleaner (2017): 정품 소프트웨어에 백도어
- NotPetya (2017): MeDoc 소프트웨어 경유

대응방안:
- 소프트웨어 무결성 검증
- 공급업체 보안 평가
- 소스코드 감사
- Zero Trust 아키텍처
```

##### AI/ML 기반 공격과 방어

```plaintext
공격:
- Adversarial ML: 탐지 시스템 우회
- DeepFake: 사회공학 공격 고도화
- AI 기반 피싱: 개인화된 스피어 피싱

방어:
- Ensemble Methods: 다중 모델 조합
- Adversarial Training: 강건성 향상
- Explainable AI: 탐지 근거 제시
```

### 2.3 데이터베이스 보안

#### 2.3.1 데이터베이스 보안 위협

##### SQL 인젝션 (SQL Injection)

- **정의**: 입력값을 통해 악의적인 SQL 문을 삽입하여 데이터베이스를 조작하는 공격
- **유형**:
  - Union 기반 인젝션
  - Boolean 기반 블라인드 인젝션
  - Time 기반 블라인드 인젝션
  - Error 기반 인젝션
- **대응 방안**:
  - 매개변수화된 쿼리 사용
  - 입력값 검증 및 필터링
  - 최소 권한 원칙 적용
  - 저장 프로시저 사용

##### 권한 에스컬레이션

- **수직 에스컬레이션**: 낮은 권한에서 높은 권한으로 상승
- **수평 에스컬레이션**: 같은 권한 레벨에서 다른 사용자 권한 획득

##### 데이터 유출

- **내부자에 의한 유출**
- **외부 침입을 통한 유출**
- **백업 데이터 유출**

#### 2.3.2 데이터베이스 보안 통제

##### 접근 제어

- **데이터베이스 수준 접근 제어**:
  - 사용자 계정 관리
  - 역할 기반 접근 제어
  - 권한 최소화
- **응용 프로그램 수준 접근 제어**:
  - 애플리케이션 인증
  - 세션 관리
  - 권한 검증

##### 암호화

- **저장 데이터 암호화 (Data at Rest)**:
  - 테이블스페이스 암호화
  - 컬럼 레벨 암호화
  - 파일 시스템 암호화
- **전송 데이터 암호화 (Data in Transit)**:
  - SSL/TLS 연결
  - VPN 터널링

##### 감사 및 모니터링

- **데이터베이스 감사 로그**:
  - 로그인 시도 기록
  - 권한 변경 기록
  - 데이터 접근 기록
  - DDL/DML 실행 기록
- **실시간 모니터링**:
  - 비정상적인 쿼리 패턴 탐지
  - 대량 데이터 추출 탐지
  - 권한 남용 탐지

#### 2.3.3 데이터베이스 보안 기능

##### 뷰 (View)

- **정의**: 하나 이상의 테이블에서 유도된 가상 테이블
- **보안 목적**: 민감한 컬럼 숨김, 행 수준 필터링

##### 저장 프로시저 (Stored Procedure)

- **정의**: 데이터베이스에 저장된 실행 가능한 코드
- **보안 장점**: SQL 인젝션 방지, 권한 제어

##### 트리거 (Trigger)

- **정의**: 특정 이벤트 발생 시 자동으로 실행되는 프로시저
- **보안 용도**: 감사 로그 생성, 무결성 제약 강화

#### 2.3.4 주요 DBMS 별 보안 기능

##### Oracle

- **Virtual Private Database (VPD)**: 행 수준 보안
- **Oracle Advanced Security**: 암호화, 레이블 기반 보안
- **Database Vault**: 권한 분리 및 통제

##### Microsoft SQL Server

- **Row-Level Security (RLS)**: 행 수준 보안
- **Transparent Data Encryption (TDE)**: 투명한 데이터 암호화
- **Always Encrypted**: 클라이언트 측 암호화

##### MySQL

- **SSL/TLS 연결 지원**
- **계정별 리소스 제한**
- **감사 로그 플러그인**

##### PostgreSQL

- **Row Security Policies**: 행 수준 보안
- **SSL 연결 지원**
- **pgAudit 확장**: 상세 감사 로그

### 2.4 웹 보안

#### 2.4.1 웹 애플리케이션 취약점

##### OWASP Top 10 (2021)

1. **Broken Access Control**: 접근 제어 취약점
2. **Cryptographic Failures**: 암호화 실패
3. **Injection**: 인젝션 공격
4. **Insecure Design**: 안전하지 않은 설계
5. **Security Misconfiguration**: 보안 설정 오류
6. **Vulnerable and Outdated Components**: 취약하고 오래된 구성요소
7. **Identification and Authentication Failures**: 식별 및 인증 실패
8. **Software and Data Integrity Failures**: 소프트웨어 및 데이터 무결성 실패
9. **Security Logging and Monitoring Failures**: 보안 로깅 및 모니터링 실패
10. **Server-Side Request Forgery (SSRF)**: 서버 측 요청 위조

##### 인젝션 공격

- **SQL 인젝션**: 데이터베이스 조작
- **NoSQL 인젝션**: NoSQL 데이터베이스 공격
- **LDAP 인젝션**: LDAP 디렉토리 조작
- **OS 명령어 인젝션**: 시스템 명령어 실행
- **XXE (XML External Entity)**: XML 외부 엔터티 참조

##### Cross-Site Scripting (XSS)

- **Stored XSS**: 서버에 저장된 악성 스크립트
- **Reflected XSS**: 요청에 포함된 악성 스크립트
- **DOM-based XSS**: 클라이언트 측 DOM 조작

##### Cross-Site Request Forgery (CSRF)

- **정의**: 사용자가 의도하지 않은 요청을 전송하도록 하는 공격
- **대응 방안**:
  - CSRF 토큰 사용
  - SameSite 쿠키 속성
  - Referrer 검증

##### 세션 관리 취약점

- **세션 하이재킹**: 세션 ID 탈취
- **세션 고정**: 특정 세션 ID 강제 사용
- **세션 예측**: 세션 ID 패턴 예측

#### 2.4.2 웹 보안 기술

##### 입력값 검증

- **화이트리스트 방식**: 허용된 값만 수용
- **블랙리스트 방식**: 금지된 값 차단
- **정규표현식**: 패턴 매칭 검증
- **길이 제한**: 버퍼 오버플로 방지

##### 출력 인코딩

- **HTML 인코딩**: HTML 특수문자 변환
- **URL 인코딩**: URL 예약문자 변환
- **JavaScript 인코딩**: JavaScript 특수문자 변환
- **CSS 인코딩**: CSS 특수문자 변환

##### 인증 및 세션 관리

- **강력한 암호 정책**
- **다중 인증 (MFA)**
- **안전한 세션 ID 생성**
- **세션 타임아웃 설정**
- **Secure 및 HttpOnly 쿠키 속성**

#### 2.4.3 웹 서버 보안

##### 아파치 (Apache) 보안

- **불필요한 모듈 제거**
- **디렉토리 인덱싱 비활성화**
- **서버 정보 숨김**: ServerTokens, ServerSignature
- **접근 제어**: .htaccess 파일 활용
- **SSL/TLS 설정**: 강력한 암호화 스위트

##### Nginx 보안

- **불필요한 모듈 제거**
- **서버 토큰 숨김**: server_tokens off
- **rate limiting**: 요청 제한
- **access control**: IP 기반 접근 제어
- **SSL/TLS 설정**: HSTS, OCSP Stapling

##### IIS (Internet Information Services) 보안

- **불필요한 기능 제거**
- **요청 필터링**: Request Filtering
- **URL 스캐닝 방지**
- **디렉토리 브라우징 비활성화**
- **SSL/TLS 설정**: 강력한 프로토콜 사용

#### 2.4.4 웹 애플리케이션 방화벽 (WAF)

##### WAF 기능

- **SQL 인젝션 방지**
- **XSS 공격 차단**
- **악성 봇 탐지**
- **DDoS 공격 완화**
- **응용 계층 공격 방어**

##### WAF 배포 모드

- **리버스 프록시 모드**: 웹 서버 앞에 배치
- **투명 브리지 모드**: 네트워크 경로에 투명하게 배치
- **임베디드 모드**: 웹 서버에 직접 통합

##### 주요 WAF 솔루션

- **Cloudflare WAF**
- **AWS WAF**
- **Akamai Web Application Protector**
- **F5 Advanced WAF**
- **ModSecurity**: 오픈소스 WAF

### 2.5 가상화 및 클라우드 보안

#### 2.5.1 가상화 보안

##### 가상화 기술 개요

- **하이퍼바이저 Type 1**: 베어메탈에 직접 설치 (VMware ESXi, Hyper-V)
- **하이퍼바이저 Type 2**: 호스트 OS 위에 설치 (VMware Workstation, VirtualBox)
- **컨테이너**: OS 수준 가상화 (Docker, LXC)

##### 가상화 보안 위협

- **VM Escape**: 가상머신에서 하이퍼바이저로 탈출
- **하이퍼바이저 공격**: 하이퍼바이저 취약점 악용
- **가상 네트워크 공격**: 가상 스위치 공격
- **리소스 고갈**: 다른 VM 에 영향을 주는 리소스 남용

##### 가상화 보안 대책

- **하이퍼바이저 강화**: 정기 패치, 불필요한 서비스 제거
- **VM 간 격리**: 네트워크 세그멘테이션, VLAN 분리
- **가상 방화벽**: VM 트래픽 제어
- **가상 패치**: 가상 어플라이언스를 통한 보안 강화

#### 2.5.2 컨테이너 보안

##### Docker 보안
- **이미지 보안**: 베이스 이미지 검증, 취약점 스캔
- **런타임 보안**: 권한 제한, 리소스 제한
- **네트워크 보안**: 사용자 정의 네트워크, 포트 제한
- **컨테이너 격리**: namespace, cgroup 활용

##### Kubernetes 보안

- **Pod Security Standards**: 보안 정책 적용
- **RBAC (Role-Based Access Control)**: 역할 기반 접근 제어
- **Network Policies**: 네트워크 트래픽 제어
- **Secrets 관리**: 민감 정보 암호화 저장

#### 2.5.3 클라우드 보안

##### 클라우드 서비스 모델별 보안 책임
- **IaaS (Infrastructure as a Service)**:
  - CSP: 물리적 인프라, 하이퍼바이저
  - 고객: OS, 미들웨어, 애플리케이션, 데이터
- **PaaS (Platform as a Service)**:
  - CSP: 인프라, OS, 미들웨어
  - 고객: 애플리케이션, 데이터
- **SaaS (Software as a Service)**:
  - CSP: 대부분의 보안 책임
  - 고객: 사용자 관리, 접근 제어

##### 클라우드 보안 위협

- **데이터 유출**: 부적절한 접근 제어
- **계정 하이재킹**: 약한 인증
- **내부자 위협**: CSP 직원의 악의적 행위
- **공유 기술 취약점**: 멀티 테넌시 환경의 격리 실패
- **데이터 손실**: 부적절한 백업 및 복구

##### 클라우드 보안 모범 사례

- **IAM (Identity and Access Management)**: 강력한 인증 및 권한 관리
- **데이터 암호화**: 저장 및 전송 데이터 암호화
- **네트워크 보안**: VPC, 보안 그룹, NACL 설정
- **모니터링**: CloudTrail, CloudWatch 등 로깅 및 모니터링
- **컴플라이언스**: 규제 요구사항 준수

#### 2.5.4 DevSecOps

##### DevSecOps 개념

- **정의**: 개발 - 보안 - 운영을 통합한 문화와 방법론
- **목표**: 보안을 개발 생명주기 전반에 통합
- **핵심 원칙**:
  - Shift-Left: 개발 초기 단계에 보안 통합
  - 자동화: 보안 테스트 자동화
  - 지속적 모니터링: 실시간 보안 상태 확인

##### DevSecOps 도구

- **정적 보안 테스트 (SAST)**: SonarQube, Checkmarx
- **동적 보안 테스트 (DAST)**: OWASP ZAP, Burp Suite
- **의존성 스캔**: OWASP Dependency Check, Snyk
- **컨테이너 스캔**: Clair, Twistlock
- **인프라 보안 스캔**: Terraform security, CloudFormation Guard